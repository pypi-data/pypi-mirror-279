-macro menu_item(name, path)
	-if view.request.path == path or (path != "/" and view.request.path.startswith(path))
		%a.button(href="{{path}}" active="true") -> =name

	-else
		%a.button(href="{{path}}") -> =name

!!!
%html
	%head
		%title << {{config.name}}: {{page}}
		%meta(charset="UTF-8")
		%meta(name="viewport" content="width=device-width, initial-scale=1")
		%link(rel="stylesheet" type="text/css" href="/theme/{{config.theme}}.css" nonce="{{view.request['hash']}}" class="theme")
		%link(rel="stylesheet" type="text/css" href="/static/style.css" nonce="{{view.request['hash']}}")
		%link(rel="stylesheet" type="text/css" href="/static/bootstrap-icons.css" nonce="{{view.request['hash']}}")
		%link(rel="manifest" href="/manifest.json")
		%script(type="application/javascript" src="/static/api.js" nonce="{{view.request['hash']}}" defer)
		-block head

	%body
		#menu.section(visible="false")
			.menu-head
				%span.menu-title << Menu
				%span#menu-close.button << &#10006;
			
			{{menu_item("Home", "/")}}

			-if view.request["user"]
				{{menu_item("Instances", "/admin/instances")}}
				{{menu_item("Whitelist", "/admin/whitelist")}}
				{{menu_item("Domain Bans", "/admin/domain_bans")}}
				{{menu_item("Software Bans", "/admin/software_bans")}}
				{{menu_item("Users", "/admin/users")}}
				{{menu_item("Config", "/admin/config")}}
				{{menu_item("Logout", "/logout")}}

			-else
				{{menu_item("Login", "/login")}}

		%ul#notifications

		#container
			#header.section
				%span#menu-open -> %i(class="bi bi-list")
				%a.title(href="/") -> =config.name
				.empty

			-if error
				%fieldset.error.section
					%legend << Error
					=error

			-if message
				%fieldset.message.section
					%legend << Message
					=message

			#content(class="page-{{page.lower().replace(' ', '_')}}")
				-block content

			#footer.section
				.col1
					-if not view.request["user"]
						%a(href="/login") << Login

					-else
						=view.request["user"]["username"]
						(
						%a(href="/logout") << Logout
						)

				.version
					%a(href="https://git.pleroma.social/pleroma/relay")
						ActivityRelay/{{version}}
