"use strict";const tarsierId="__tarsier_id",tarsierSelector=`#${tarsierId}`,elIsClean=t=>{const i=t.getBoundingClientRect(),n=window.getComputedStyle(t),o=n.visibility==="hidden"||n.display==="none"||t.hidden||t.disabled,s=n.opacity==="0",e=i.width===0||i.height===0,a=t.tagName==="SCRIPT"||t.tagName==="STYLE";return!o&&!s&&!e&&!a},inputs=["a","button","textarea","select","details","label"],isInteractable=t=>inputs.includes(t.tagName.toLowerCase())||t.tagName.toLowerCase()==="input"&&t.type!=="hidden"||t.role==="button",text_input_types=["text","password","email","search","url","tel","number"],isTextInsertable=t=>t.tagName.toLowerCase()==="textarea"||t.tagName.toLowerCase()==="input"&&text_input_types.includes(t.type),emptyTagWhitelist=["input","textarea","select","button"],isEmpty=t=>{const i=t.tagName.toLowerCase();if(emptyTagWhitelist.includes(i)||t.childElementCount>0)return!1;if("innerText"in t&&t.innerText.trim().length===0){const n=t.querySelector("svg"),o=t.querySelector("img");return n||o?!1:isElementInViewport(t)}return!1};function isElementInViewport(t){const i=t.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&i.right<=(window.innerWidth||document.documentElement.clientWidth)}function getElementXPath(t){let i=[],n="";for(t&&t.ownerDocument!==window.document&&(n=`iframe[${t.getAttribute("iframe_index")}]`);t;){if(!t.tagName){t=t.parentNode;continue}let o=t.tagName.toLowerCase(),s=1,e=t.previousElementSibling;for(;e;)e.tagName===t.tagName&&s++,e=e.previousElementSibling;let a=t.nextElementSibling,l=!1;for(;a;){if(a.tagName===t.tagName){l=!0;break}a=a.nextElementSibling}if((s>1||l)&&(o+=`[${s}]`),t.id){if(o+=`[@id="${t.id}"]`,i.length>3)return i.unshift(o),"//"+i.join("/")}else if(t.className){const p=Array.from(t.classList);o+=`[@class="${t.className}"]`}i.unshift(o),t=t.parentNode}return n+"//"+i.join("/")}function create_tagged_span(t,i){let n;isInteractable(i)?isTextInsertable(i)?n=`[#${t}]`:i.tagName.toLowerCase()=="a"?n=`[@${t}]`:n=`[$${t}]`:n=`[${t}]`;let o=document.createElement("span");return o.id=tarsierId,o.style.position="relative",o.style.display="inline",o.style.color="white",o.style.backgroundColor="red",o.style.padding="1.5px",o.style.borderRadius="3px",o.style.fontWeight="bold",o.style.fontFamily="Arial",o.style.margin="1px",o.style.lineHeight="1.25",o.style.letterSpacing="2px",o.style.zIndex="2140000046",o.style.clip="auto",o.style.height="fit-content",o.style.width="fit-content",o.style.minHeight="fit-content",o.style.minWidth="fit-content",o.style.maxHeight="unset",o.style.maxWidth="unset",o.textContent=n,o.style.webkitTextFillColor="white",o.style.textShadow="",o.style.textDecoration="none",o.style.letterSpacing="0px",o}window.tagifyWebpage=(t=!1)=>{window.removeTags(),hideMapElements();let i=0,n={},o=[...document.body.querySelectorAll("*")];const s=document.getElementsByTagName("iframe");for(let e=0;e<s.length;e++)try{const a=s[e];console.log("iframe!",s[e]);const p=[...(a.contentDocument||a.contentWindow?.document).querySelectorAll("*")];p.forEach(d=>d.setAttribute("iframe_index",e)),o.push(...p)}catch(a){console.error("Cross-origin iframe:",a)}o.map(e=>{isInteractable(e)&&(e.childNodes.forEach(a=>{const l=o.indexOf(a);l>-1&&o.splice(l,1)}),e.querySelectorAll("*").forEach(a=>{const l=o.indexOf(a);l>-1&&isInteractable(a)&&o.splice(l,1)}))});for(let e of o)if(!(isEmpty(e)||!elIsClean(e))){if(isInteractable(e))n[i]=getElementXPath(e),i++;else if(t)for(let a of Array.from(e.childNodes))a.nodeType===Node.TEXT_NODE&&/\S/.test(a.textContent||"")&&(n[i]=getElementXPath(e),i++)}i=0;for(let e of o){if(isEmpty(e)||!elIsClean(e))continue;let a=create_tagged_span(i,e);if(isInteractable(e))isTextInsertable(e)&&e.parentElement?e.parentElement.insertBefore(a,e):e.prepend(a),i++;else if(t){for(let l of Array.from(e.childNodes))if(l.nodeType===Node.TEXT_NODE&&/\S/.test(l.textContent||"")){let p=create_tagged_span(i,e);e.insertBefore(p,l),i++}}}return absolutelyPositionMissingTags(),n};function absolutelyPositionMissingTags(){const i=document.querySelectorAll(tarsierSelector);i.forEach(n=>{const o=n.parentElement,s=o.getBoundingClientRect();let e=n.getBoundingClientRect();const a={x:(s.left+s.right)/2,y:(s.top+s.bottom)/2},l={x:(e.left+e.right)/2,y:(e.top+e.bottom)/2},p=Math.abs(a.x-l.x),d=Math.abs(a.y-l.y);if(p>500||d>500||!elIsClean(n)){n.style.position="absolute";let r=Math.max(0,s.left-(e.right+3-e.left));r=Math.min(r,window.innerWidth-(e.right-e.left));let c=Math.max(0,s.top+3);c=Math.min(c,Math.max(window.innerHeight,document.documentElement.scrollHeight)-(e.bottom-e.top)),n.style.left=`${r}px`,n.style.top=`${c}px`,o.removeChild(n),document.body.appendChild(n)}i.forEach(r=>{if(n===r)return;let c=r.getBoundingClientRect(),m=parseFloat(window.getComputedStyle(n).fontSize.split("px")[0]),g=parseFloat(window.getComputedStyle(r).fontSize.split("px")[0]);for(;e.left<c.right&&e.right>c.left&&e.top<c.bottom&&e.bottom>c.top&&m>7&&g>7;)m-=.5,g-=.5,n.style.fontSize=`${m}px`,r.style.fontSize=`${g}px`,e=n.getBoundingClientRect(),c=r.getBoundingClientRect()})})}window.removeTags=()=>{document.querySelectorAll(tarsierSelector).forEach(i=>i.remove()),showMapElements()};const GOOGLE_MAPS_OPACITY_CONTROL="__reworkd_google_maps_opacity",hideMapElements=()=>{const t=['iframe[src*="google.com/maps"]','iframe[id*="gmap_canvas"]',".maplibregl-map",".mapboxgl-map",".leaflet-container",'img[src*="maps.googleapis.com"]','[aria-label="Map"]',".cmp-location-map__map",'.map-view[data-role="mapView"]',".google_Map-wrapper",".google_map-wrapper",".googleMap-wrapper",".googlemap-wrapper",".ls-map-canvas",".gmapcluster","#googleMap","#googleMaps","#googlemaps","#googlemap","#google_map","#google_maps","#MapId",".geolocation-map-wrapper",".locatorMap"];document.querySelectorAll(t.join(", ")).forEach(i=>{const n=window.getComputedStyle(i).opacity;i.setAttribute("data-original-opacity",n),i.style.opacity="0"})},showMapElements=()=>{document.querySelectorAll(`[${GOOGLE_MAPS_OPACITY_CONTROL}]`).forEach(i=>{i.style.opacity=i.getAttribute("data-original-opacity")||"1"})};
