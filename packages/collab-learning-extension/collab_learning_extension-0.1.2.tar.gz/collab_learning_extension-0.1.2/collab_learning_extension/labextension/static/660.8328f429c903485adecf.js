"use strict";(self.webpackChunkcollab_learning_extension=self.webpackChunkcollab_learning_extension||[]).push([[660],{5580:(e,t,n)=>{n.r(t),n.d(t,{FACTORY:()=>dn,IPuzzleDocTracker:()=>un,default:()=>pn});var r=n(8436),l=(n(1836),n(6371)),a=n(8440),i=n(7262),o=n(9265),s=n(667),c=n(5726);class d extends c.Maintainer{}class u extends c.Maintainer{}var m=n(5486);const p=(0,m.createSlice)({name:"cells",initialState:{byId:{},allIds:[]},reducers:{addCell(e,t){e.byId[t.payload.id]=t.payload,e.allIds.push(t.payload.id)},deleteCell(e,t){delete e.byId[t.payload],e.allIds=e.allIds.filter((e=>e!==t.payload))},setCells(e,t){e.byId=t.payload.byId,e.allIds=t.payload.allIds},updateCellProperty(e,t){e.byId[t.payload.id][t.payload.key]=t.payload.value},updateCellsAllIds(e,t){e.allIds=t.payload}}}),{addCell:h,deleteCell:b,setCells:g,updateCellProperty:y,updateCellsAllIds:f}=p.actions,I=(0,m.createSelector)([e=>e.cells.byId,(e,t)=>t],((e,t)=>e[t])),C=p.reducer,v=(0,m.createSlice)({name:"kernelExecutionResult",initialState:{byId:{},allIds:[]},reducers:{setKernelExecutionResult(e,t){e.byId[t.payload.referenceId]=t.payload,e.allIds.push(t.payload.referenceId)},removeKernelExecutionResult(e,t){e.byId[t.payload]&&(delete e.byId[t.payload],e.allIds=e.allIds.filter((e=>e!==t.payload)))}}}),{setKernelExecutionResult:E,removeKernelExecutionResult:w}=v.actions,x=(e,t)=>e.kernelExecutionResult.byId[t],S=v.reducer,O=(0,m.createSlice)({name:"kernelTestResult",initialState:{byId:{},allIds:[]},reducers:{setKernelTestResult(e,t){e.byId[t.payload.referenceId]=t.payload,e.allIds.push(t.payload.referenceId)},removeKernelTestResult(e,t){e.byId[t.payload]&&(delete e.byId[t.payload],e.allIds=e.allIds.filter((e=>e!==t.payload)))}}}),{setKernelTestResult:_,removeKernelTestResult:F}=O.actions,j=(e,t)=>e.kernelTestResult.byId[t],P=O.reducer,k=(0,m.createSlice)({name:"user",initialState:{identity:null,userRole:"student"},reducers:{setToStudent(e){e.userRole="student"},setToInstructor(e){e.userRole="instructor"},setIdentity(e,t){e.identity=t.payload}}}),{setToStudent:N,setToInstructor:M,setIdentity:T}=k.actions,A=e=>e.user.identity,z=e=>e.user.userRole,D=k.reducer,R=(0,m.createSlice)({name:"fields",initialState:{byId:{},allIds:[]},reducers:{addField(e,t){e.byId[t.payload.id]=t.payload,e.allIds.push(t.payload.id)},deleteField(e,t){delete e.byId[t.payload],e.allIds=e.allIds.filter((e=>e!==t.payload)),w(t.payload)},updateFieldProperty(e,t){e.byId[t.payload.id][t.payload.key]=t.payload.value},setFields(e,t){e.byId=t.payload.byId,e.allIds=t.payload.allIds},updateFieldsAllIds(e,t){e.allIds=t.payload}}}),{addField:K,deleteField:H,updateFieldProperty:L,setFields:V,updateFieldsAllIds:B}=R.actions,U=e=>e.fields.byId,J=(0,m.createSelector)([U,(e,t)=>t],((e,t)=>e[t])),W=(0,m.createSelector)([U,(e,t)=>t],((e,t)=>t.map((t=>e[t])))),q=(0,m.createSelector)([e=>e.cells.byId,U,(e,t,n)=>t,(e,t,n)=>n],((e,t,n,r)=>e[n].studentSolutionIds.filter((e=>{var n;return(null===(n=t[e])||void 0===n?void 0:n.createdBy)===r})).map((e=>t[e])).find((e=>e)))),Y=R.reducer,G=(0,m.configureStore)({reducer:{fields:Y,cells:C,user:D,kernelExecutionResult:S,kernelTestResult:P}});class $ extends c.RootObserver{constructor(){super(...arguments),Object.defineProperty(this,"rootDispatcher",{enumerable:!0,configurable:!0,writable:!0,value:e=>{G.dispatch(g(e))}}),Object.defineProperty(this,"addDispatcher",{enumerable:!0,configurable:!0,writable:!0,value:e=>{G.dispatch(h(e))}}),Object.defineProperty(this,"deleteDispatcher",{enumerable:!0,configurable:!0,writable:!0,value:e=>{G.dispatch(b(e))}}),Object.defineProperty(this,"updatePropertyDispatcher",{enumerable:!0,configurable:!0,writable:!0,value:e=>{G.dispatch(y(e))}}),Object.defineProperty(this,"allIdsDispatcher",{enumerable:!0,configurable:!0,writable:!0,value:e=>{G.dispatch(f(e))}})}}class Q extends c.RootObserver{constructor(){super(...arguments),Object.defineProperty(this,"rootDispatcher",{enumerable:!0,configurable:!0,writable:!0,value:e=>{G.dispatch(V(e))}}),Object.defineProperty(this,"addDispatcher",{enumerable:!0,configurable:!0,writable:!0,value:e=>{G.dispatch(K(e))}}),Object.defineProperty(this,"deleteDispatcher",{enumerable:!0,configurable:!0,writable:!0,value:e=>{G.dispatch(H(e))}}),Object.defineProperty(this,"updatePropertyDispatcher",{enumerable:!0,configurable:!0,writable:!0,value:e=>{G.dispatch(L(e))}}),Object.defineProperty(this,"allIdsDispatcher",{enumerable:!0,configurable:!0,writable:!0,value:e=>{G.dispatch(B(e))}})}}class X{create(e){return this.createSpecific(e)}}class Z extends X{createField(){return{id:i.UUID.uuid4()}}}class ee extends Z{get identifier(){return"code"}createSpecific(){return{...this.createField(),src:"",type:"code",language:"python"}}}class te extends Z{get identifier(){return"markdown"}createSpecific(){return{...this.createField(),src:"",type:"markdown"}}}class ne extends Z{get identifier(){return"multiple-choice-item"}createSpecific(){return{...this.createField(),src:""}}}class re extends Z{get identifier(){return"test-code"}createSpecific(){return{...this.createField(),src:"",type:"test-code",language:"python",name:"",verified:!1,createdBy:""}}}class le{constructor(){Object.defineProperty(this,"factories",{enumerable:!0,configurable:!0,writable:!0,value:[]})}create(e,t){return this.findFactory(e).create(t)}findFactory(e){const t=this.factories.find((t=>t.identifier===e));if(void 0!==t)return t;throw Error("Factory for type: "+e+" was not found")}}class ae extends Z{createField(){return{...super.createField(),comment:"",grade:-1,createdBy:"",submitted:!1}}}class ie extends ae{get identifier(){return"code-solution"}createSpecific(){return{...this.createField(),language:"python",src:"",type:"code-solution"}}}class oe extends ae{get identifier(){return"multiple-choice-solution"}createSpecific(){return{...this.createField(),type:"multiple-choice-solution",src:[]}}}class se extends ae{get identifier(){return"text-solution"}createSpecific(){return{...this.createField(),type:"text-solution",src:""}}}class ce extends le{static get instance(){return this._instance}constructor(){super(),this.factories.push(new ee,new te,new ne,new re),this.factories.push(new ie,new oe,new se)}}Object.defineProperty(ce,"_instance",{enumerable:!0,configurable:!0,writable:!0,value:new ce});const de=ce;class ue extends X{constructor(){super()}_createCell(e){return{id:i.UUID.uuid4(),type:this.identifier,descriptionId:e("markdown"),studentSolutionIds:[],visible:!1,showSolution:!1}}}class me extends ue{get identifier(){return"code-cell"}get text(){return"Coding Exercise"}createSpecific(e){return{...this._createCell(e),type:"code-cell",startingCodeId:e("code"),solutionCodeId:e("code"),testingCodeIds:[]}}}class pe extends ue{get text(){return"Text response"}get identifier(){return"text-cell"}createSpecific(e){return{...this._createCell(e),type:"text-cell",solutionId:e("markdown")}}}class he extends ue{get text(){return"Multiple choice"}get identifier(){return"multiple-choice-cell"}createSpecific(e){return{...this._createCell(e),type:"multiple-choice-cell",solutionOptions:[],options:[],multi:!1,random:!1}}}class be extends le{static get instance(){return this._instance}constructor(){super(),this.factories.push(new me),this.factories.push(new pe),this.factories.push(new he)}getFactoryNamings(){return this.factories.map((e=>({id:e.identifier,name:e.text})))}}Object.defineProperty(be,"_instance",{enumerable:!0,configurable:!0,writable:!0,value:new be});const ge=be;var ye=n(4602);class fe{constructor(){Object.defineProperty(this,"onStreamMessage",{enumerable:!0,configurable:!0,writable:!0,value:e=>({output:e.text,type:"stream"})}),Object.defineProperty(this,"getErrorMessage",{enumerable:!0,configurable:!0,writable:!0,value:e=>e.ename+(e.evalue?": "+e.evalue:"")}),Object.defineProperty(this,"onError",{enumerable:!0,configurable:!0,writable:!0,value:e=>({output:e,type:"error"})}),Object.defineProperty(this,"onOutputObject",{enumerable:!0,configurable:!0,writable:!0,value:e=>"object"==typeof e.data?{...this.getDataObjectOutputValue(e)}:null})}getDataObjectOutputValue(e){const t=e.data;return void 0!==t["application/json"]?{output:t["application/json"],type:"application/json"}:void 0!==t["image/png"]?{output:t["image/png"],type:"image/png"}:void 0!==t["text/html"]?{output:t["text/html"],type:"text/html"}:void 0!==t["text/plain"]?{output:t["text/plain"],type:"text/plain"}:{output:"Output type not supported",type:"error"}}}class Ie{constructor(){Object.defineProperty(this,"_executeCode",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{const n=[];return new Promise(((r,l)=>{var a,i,o;t&&(null===(a=t.session)||void 0===a?void 0:a.kernel)&&((null===(o=null===(i=t.session)||void 0===i?void 0:i.kernel)||void 0===o?void 0:o.requestExecute({code:e.src})).onIOPub=t=>{const l=t.header.msg_type;console.debug("message type: "+l+" for: "+e.referenceId);const a=t.content;switch(l){case"execute_result":{const e=this._executionOutputHelper.onOutputObject(a);e&&n.push(e);break}case"display_data":{const e=this._executionOutputHelper.onOutputObject(a);e&&n.push(e);break}case"error":n.push(this._executionOutputHelper.onError(this._executionOutputHelper.getErrorMessage(a)));break;case"stream":n.push(this._executionOutputHelper.onStreamMessage(a));break;case"status":"idle"===a.execution_state&&r(n)}})}))}}),Object.defineProperty(this,"_executionOutputHelper",{enumerable:!0,configurable:!0,writable:!0,value:new fe}),Object.defineProperty(this,"_verifiedTestSignal",{enumerable:!0,configurable:!0,writable:!0,value:new ye.Signal(this)})}static get instance(){return this._instance}get verifiedTestSignal(){return this._verifiedTestSignal}executeCode(e,t){this._executeCode(e,t).then((t=>G.dispatch(E({referenceId:e.referenceId,outputs:t}))))}executeTest(e,t){this._executeTest(e,t).then((t=>G.dispatch(_({referenceId:e.referenceId,result:t}))))}verifyTest(e,t){this._executeTest(e,t).then((t=>{t&&this._verifiedTestSignal.emit({referenceId:e.referenceId}),G.dispatch(_({referenceId:e.referenceId,result:t}))}))}_executeTest(e,t){return new Promise(((n,r)=>{var l,a,i;if(!e.src.includes("assert")||!t||!(null===(l=t.session)||void 0===l?void 0:l.kernel))return G.dispatch(E({referenceId:e.referenceId,outputs:[this._executionOutputHelper.onError("No asserts were found in the test code")]})),n(!1);(null===(i=null===(a=t.session)||void 0===a?void 0:a.kernel)||void 0===i?void 0:i.requestExecute({code:e.src})).onIOPub=t=>{const r=t.header.msg_type,l=t.content;switch(r){case"status":if("idle"===l.execution_state)return n(!0);break;case"error":return G.dispatch(E({referenceId:e.referenceId,outputs:[this._executionOutputHelper.onError(this._executionOutputHelper.getErrorMessage(l))]})),n(!1)}}}))}}Object.defineProperty(Ie,"_instance",{enumerable:!0,configurable:!0,writable:!0,value:new Ie});class Ce extends s.YDocument{constructor(){super(),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:"1.0.0"}),Object.defineProperty(this,"_cellsMaintainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fieldsMaintainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fieldsObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_cellsObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const e=this.ydoc.getMap("cells"),t=this.ydoc.getMap("fields");this._cellsMaintainer=new u(e,this.transact.bind(this)),this._fieldsMaintainer=new d(t,this.transact.bind(this)),this._cellsObserver=new $(e),this._fieldsObserver=new Q(t),Ie.instance.verifiedTestSignal.connect(((e,t)=>{const n=this._fieldsMaintainer.getObjectAsJson(t.referenceId);n.verified=!0,this._fieldsMaintainer.changeObject(n)}))}dispose(){this.isDisposed||(super.dispose(),this._fieldsObserver.dispose(),this._cellsObserver.dispose())}static create(){return new Ce}get cells(){return[]}addCell(e,t){this.transact((()=>{this._cellsMaintainer.addObject(ge.instance.create(e,(e=>this.fieldCreation(e,t))))}))}deleteCell(e){this._cellsMaintainer.deleteObject(e,((e,t)=>{this._fieldsMaintainer.deleteObject(t)}))}changeCell(e){this._cellsMaintainer.changeObject(e)}swapCellPosition(e,t){this._cellsMaintainer.swapObjectPosition(e,t)}changeField(e){this._fieldsMaintainer.changeObject(e)}addFieldToPropertyArray(e,t,n,r){this.transact((()=>{this._cellsMaintainer.addToPropertyArray(e,t,this.fieldCreation(n,r))}))}removeFieldFromPropertyArray(e,t,n){this._cellsMaintainer.removeFromPropertyArray(e,t,n,(()=>{this._fieldsMaintainer.deleteObject(n)}))}swapInPropertyArray(e,t,n,r){this._cellsMaintainer.swapInPropertyArray(e,t,n,r)}fieldCreation(e,t){const n=de.instance.create(e,(e=>this.fieldCreation(e,t)));return n.createdBy=t,this._fieldsMaintainer.addObject(n),n.id}}var ve=n(921),Ee=n(3345),we=n.n(Ee),xe=n(9316);const Se=()=>{const e=(0,xe.useSelector)((e=>z(e))),t=(0,xe.useDispatch)();return we().createElement("div",{className:"form-control items-end"},we().createElement("label",{className:"label cursor-pointer"},we().createElement("span",{className:"label-text mr-2"},"Instructor"),we().createElement("input",{type:"checkbox",className:"checkbox checkbox-sm",defaultChecked:"instructor"===e,onChange:e=>{e.target.checked?t(M()):t(N())}})))},Oe=(0,Ee.createContext)(null),_e=e=>we().createElement(Oe.Provider,{value:{...e,addStudentSolutionField:(t,n)=>{e.addFieldToPropertyArray(t,"studentSolutionIds",n)},addTestCodeField:t=>e.addFieldToPropertyArray(t,"testingCodeIds","test-code"),removeTestCodeField:(t,n)=>e.removeFieldFromPropertyArray(t,"testingCodeIds",n),addMultipleChoiceOption:t=>{e.addFieldToPropertyArray(t,"options","multiple-choice-item")},removeMultipleChoiceOption:(t,n)=>{e.removeFieldFromPropertyArray(t,"options",n)},swapPositionOfMultipleChoiceOption:(t,n,r)=>{e.swapInPropertyArray(t,"options",n,r)}}},e.children),Fe=({label:e,className:t,icon:n,disabled:r=!1,onClick:l})=>we().createElement("button",{onClick:l,className:"btn btn-light btn-sm "+t,disabled:r},e?n?e+" ":e:""," ",n&&we().createElement("span",{dangerouslySetInnerHTML:{__html:n}})),je=e=>we().createElement("div",{className:"flex justify-end "+e.className},e.children),Pe=({onSubmit:e,onUndo:t,submitted:n=!1,showBadgeOnSubmitted:r=!1,finalized:l=!1,labelSubmit:a="Submit",labelUndoSubmit:i="Undo Submission",iconSubmit:o,iconUndoSubmit:s,className:c=""})=>we().createElement(je,{className:c},r&&n&&we().createElement("span",{className:"badge badge-success mr-4"},"Submitted"),we().createElement(Fe,{onClick:e,disabled:n,label:a,icon:o}),!l&&we().createElement(Fe,{className:"ml-4",onClick:t,disabled:!n,label:i,icon:s}));var ke=n(4546);const Ne=e=>we().createElement(ke.CodeComponent,{language:e.language,onCodeChange:e.onChange,src:e.src,config:{options:e.readonly?ke.readonlyAdjustableHeightCodeOptions:ke.adjustableHeightCodeOptions}}),Me=({borderOnHover:e=!1,children:t,className:n})=>we().createElement("div",{className:"relative transition-all ease-in-out duration-300 group mt-2 "+n+(e?" hover:border-solid hover:border-base-200 border-2 border-base-100":"border-solid border-base-200 border-2"),style:{minHeight:"24px"}},t),Te=({children:e})=>we().createElement("div",{className:"pl-4 pr-4 pt-1 pb-1 w-full"},e),Ae=({children:e,className:t,showOnHover:n=!0,absolute:r=!1})=>we().createElement(je,{className:t},we().createElement("div",{className:(n?"transition ease-in-out duration-200 opacity-0 group-hover:opacity-100 ":"")+(r?"absolute top-0 right-0 z-10":"inline-flex")},r?we().createElement("div",{className:"inline-flex"}," ",e," "):e)),ze=({icon:e,hide:t=!1,disabled:n=!1,onClick:r})=>t?we().createElement(we().Fragment,null):we().createElement("button",{className:"btn rounded-none btn-square btn-sm p-2",onClick:r,disabled:n}," ",we().createElement("span",{dangerouslySetInnerHTML:{__html:e}})),De=({checked:e,label:t,onChange:n})=>we().createElement("div",{className:"form-control bg-base-200 w-fit flex justify-center pl-2 pr-2 shadow-sm"},we().createElement("label",{className:"label cursor-pointer p-0"},we().createElement("span",{className:"label-text pr-2"},t),we().createElement("input",{type:"checkbox",className:"toggle toggle-xs",onChange:e=>n(e.target.checked),checked:e}))),Re=({label:e,children:t})=>we().createElement(Me,{className:"indicator w-full pt-3 pb-3"},e&&we().createElement("div",{className:"indicator-item indicator-center badge text-center"},e),we().createElement(Te,null,t));var Ke=n(555),He=n.n(Ke),Le=n(5579),Ve=n.n(Le);const Be={rehypePlugins:[He()],remarkPlugins:[Ve()]},Ue=e=>we().createElement(ke.MarkdownEditorComponent,{config:{jupyter:!0,markdownConfig:Be,codeConfig:e.codeConfig},src:e.src,onChange:e.onChange});var Je=n(8745),We=n.n(Je);const qe=({html:e})=>{return we().createElement("div",{dangerouslySetInnerHTML:(t=e,{__html:We().sanitize(t,{ADD_ATTR:["border"],FORBID_TAGS:["style"],FORBID_ATTR:["style"],USE_PROFILES:{html:!0}})})});var t},Ye=({isInstructor:e,src:t,onChange:n})=>we().createElement(we().Fragment,null,e?we().createElement(Re,{label:"Exercise description"},we().createElement(Ue,{src:t,onChange:n})):we().createElement(ke.MarkdownComponent,{src:t})),Ge=({name:e,onNameChange:t})=>we().createElement("div",{className:"input-group mb-3"},we().createElement("input",{type:"text",placeholder:"Test name",className:"input input-bordered input-sm w-full",value:e,onChange:e=>t(e.target.value)})),$e=({children:e,label:t="Configuration"})=>we().createElement(Re,{label:t},e),Qe=({label:e,value:t,onChange:n})=>we().createElement("div",{className:"form-control"},we().createElement("label",{className:"cursor-pointer label"},we().createElement("span",{className:"label-text"},e),we().createElement("input",{type:"checkbox",onChange:e=>n(e.target.checked),checked:t,className:"checkbox checkbox-sm"})));var Xe=n(2126);const Ze=({content:e,optionId:t,index:n,maxIndex:r,selected:l,options:a,onItemContentChange:i,onSelectionChange:o,swapPosition:s,remove:c})=>we().createElement(Me,null,we().createElement(Ae,{showOnHover:!1},we().createElement(ze,{hide:a.randomOrder,disabled:0===n,icon:Xe.moveUpIcon.svgstr,onClick:()=>{s(n,n-1)}}),we().createElement(ze,{hide:a.randomOrder,disabled:r===n,icon:Xe.moveDownIcon.svgstr,onClick:()=>{s(n,n+1)}}),we().createElement(ze,{icon:Xe.deleteIcon.svgstr,onClick:c})),we().createElement(Te,null,we().createElement("div",{className:"flex flex-row"},we().createElement("div",{className:"flex-grow"},we().createElement(Ue,{src:e,onChange:i})),we().createElement("label",{className:"label"},we().createElement("div",{className:"cursor-pointer"},a.multi?we().createElement("input",{type:"checkbox",onChange:e=>o(t,e.target.checked),checked:l,className:"checkbox checkbox-sm"}):we().createElement("input",{type:"radio",name:"radio-"+t,className:"radio radio-sm",defaultChecked:l,onChange:e=>o(t,e.target.checked)})))))),et=({children:e,addMultipleChoiceOption:t})=>we().createElement(we().Fragment,null,e,we().createElement(je,{className:"mt-2"},we().createElement(Fe,{icon:Xe.addIcon.svgstr,onClick:t}))),tt=({src:e,onChange:t})=>we().createElement(Re,{label:"Solution"},we().createElement(Ue,{src:e,onChange:t})),nt=({options:e,items:t,solutionOptions:n,answer:r,onAnswerChanges:l,setSubmit:a})=>we().createElement(we().Fragment,null,we().createElement(ke.MultipleChoiceComponent,{exerciseObject:{items:t,correctAnswers:n,metadata:{multi:e.multi,disabled:e.submitted,showEvaluation:e.submitted&&e.showSolution,showIndicator:e.submitted&&e.showSolution,random:e.random,markdownConfig:Be,multipleChoiceItemColoring:{}}},onAnswerChanges:l,initialAnswer:{answer:r}}),we().createElement(Pe,{finalized:e.showSolution,showBadgeOnSubmitted:!0,submitted:e.submitted,onSubmit:()=>a(!0),onUndo:()=>a(!1)})),rt=({options:e,answer:t,solution:n,setSubmit:r,onAnswerChanges:l})=>{const a=e.submitted?ke.readonlyAdjustableHeightCodeOptions:ke.adjustableHeightCodeOptions;return we().createElement(we().Fragment,null,we().createElement(ke.TextResponseComponent,{exerciseObject:{solution:n,metadata:{showSolution:e.showSolution&&e.submitted,markdownEditorConfig:{jupyter:!0,markdownConfig:Be,codeConfig:{options:a}}}},initialAnswer:{answer:{src:t}},onAnswerChanges:l}),we().createElement(Pe,{className:"mt-2",finalized:e.showSolution,showBadgeOnSubmitted:!0,submitted:e.submitted,onSubmit:()=>r(!0),onUndo:()=>r(!1)}))};var lt=n(6938);const at={"text/html":({output:e})=>we().createElement(qe,{html:e}),"application/json":({output:e})=>we().createElement(lt.JsonView,{data:e,style:{...lt.defaultStyles,container:"bg-base-100"}}),"image/png":({output:e})=>we().createElement("img",{src:`data:image/png;base64,${e}`}),error:({output:e})=>we().createElement("div",{className:"alert alert-error rounded-none",style:{whiteSpace:"pre-wrap"}},e),default:({output:e})=>we().createElement("div",{className:"alert alert-base-200 rounded-none",style:{whiteSpace:"pre-wrap"}},e)},it=({object:e})=>{const t=at[e.type]||at.default;return e.output?we().createElement(t,{output:e.output}):we().createElement(we().Fragment,null)},ot=({objects:e,showIndex:t=!0})=>{const n=e.map(((e,n)=>we().createElement("div",{className:"flex"},t&&we().createElement("span",{className:"pr-2"},"[",n+1,"]"),we().createElement(it,{key:n,object:e}))));return we().createElement("div",{className:"flex flex-col space-y-4"},n)};function st({fieldId:e}){const t=(0,xe.useSelector)((t=>J(t,e))),n="instructor"===(0,xe.useSelector)((e=>z(e))),{changeField:r}=(0,Ee.useContext)(Oe);return void 0===t?we().createElement(we().Fragment,null):we().createElement(Ye,{isInstructor:n,onChange:e=>{r({...t,src:e})},src:t.src})}const ct=(0,Ee.createContext)(null),dt=e=>we().createElement(ct.Provider,{value:{...e}},e.children);function ut(e){const t="instructor"===(0,xe.useSelector)((e=>z(e))),n=(0,xe.useSelector)((e=>e.cells.allIds.length)),r=(0,xe.useSelector)((t=>I(t,e.cellId))),{deleteCell:l,swapCellPosition:a,changeCell:i}=(0,Ee.useContext)(Oe);return we().createElement(we().Fragment,null,t&&we().createElement(we().Fragment,null,we().createElement(Ae,{showOnHover:!0},we().createElement(De,{checked:r.showSolution,onChange:e=>i({...r,showSolution:e}),label:"Show Solution"}),we().createElement(De,{checked:r.visible,onChange:e=>i({...r,visible:e}),label:"Visibility"}),we().createElement(ze,{disabled:0===e.index,icon:Xe.moveUpIcon.svgstr,onClick:()=>{const t=e.index-1;a(e.index,t)}}),we().createElement(ze,{disabled:n-1===e.index,icon:Xe.moveDownIcon.svgstr,onClick:()=>{const t=e.index+1;a(e.index,t)}}),we().createElement(ze,{icon:Xe.deleteIcon.svgstr,onClick:()=>{l(e.cellId)}}))))}function mt(e){const t="instructor"===(0,xe.useSelector)((e=>z(e))),n=(0,xe.useSelector)((t=>I(t,e).showSolution));return{permitted:e=>((e=>e.instructorOnly&&t||!e.instructorOnly)(e)||(e=>e.whenShowSolutionOnly&&n)(e))&&(e=>e.studentOnly&&!t||!e.studentOnly)(e)}}function pt(e){const{permitted:t}=mt(e.cellId);return t(e)?we().createElement("input",{type:"radio",name:e.cellId+"-"+e.name,role:"tab",className:"tab",style:{width:"max-content"},"aria-label":e.label,defaultChecked:e.checked}):we().createElement(we().Fragment,null)}function ht(e){const{permitted:t}=mt(e.cellId);return t(e)?we().createElement("div",{role:"tabpanel",className:"tab-content p-10"},e.children):we().createElement(we().Fragment,null)}const bt={name:"code-tab",label:"Your Code",studentOnly:!0},gt={name:"code-tab",label:"Starting Code",instructorOnly:!0};function yt(e){const t=(0,Ee.useMemo)((()=>()=>{e.input.forEach((t=>{e.execute(t)}))}),[e.input,e.execute]);return we().createElement(Fe,{label:e.additionalLabel,icon:e.icon.svgstr,onClick:t})}function ft(e){const{executeCode:t}=(0,Ee.useContext)(ct);return we().createElement(yt,{icon:Xe.runIcon,execute:t,additionalLabel:e.additionalLabel,input:e.input})}function It(e){const{createKernelExecution:t}={createKernelTestVerification:(e,t,...n)=>({referenceId:e,src:n.map((e=>e.src)).join("\r\n"),cellId:t}),createKernelExecution:(e,...t)=>[{referenceId:e,src:t.map((e=>e.src)).join("\r\n")}],createMultipleKernelExecution:(e,...t)=>e.map((e=>({referenceId:e.id,src:t.map((e=>e.src)).join("\r\n")+"\r\n"+e.src})))},{changeField:n}=(0,Ee.useContext)(Oe),r=(0,xe.useSelector)((t=>J(t,I(t,e.cellId).startingCodeId))),l=(0,xe.useSelector)((e=>x(e,r.id)));return void 0===r?we().createElement(we().Fragment,null):we().createElement(we().Fragment,null,we().createElement(ke.CodingComponent,{exerciseObject:{metadata:{answerCodeConfig:{options:ke.adjustableHeightCodeOptions}}},onAnswerChanges:e=>n({...r,src:e.answer.src}),initialAnswer:{answer:{...r}}}),we().createElement(je,null,we().createElement(ft,{input:t(r.id,r)})),we().createElement(ot,{objects:l?l.outputs.map((e=>({output:e.output,type:e.type}))):[]}))}const Ct={name:"code-tab",label:"Solution Code",instructorOnly:!0,whenShowSolutionOnly:!0};function vt(e){const{createKernelExecution:t}={createKernelTestVerification:(e,t,...n)=>({referenceId:e,src:n.map((e=>e.src)).join("\r\n"),cellId:t}),createKernelExecution:(e,...t)=>[{referenceId:e,src:t.map((e=>e.src)).join("\r\n")}],createMultipleKernelExecution:(e,...t)=>e.map((e=>({referenceId:e.id,src:t.map((e=>e.src)).join("\r\n")+"\r\n"+e.src})))},{changeField:n}=(0,Ee.useContext)(Oe),r="instructor"===(0,xe.useSelector)((e=>z(e))),l=(0,xe.useSelector)((t=>J(t,I(t,e.cellId).startingCodeId))),a=(0,xe.useSelector)((t=>J(t,I(t,e.cellId).solutionCodeId))),i=(0,xe.useSelector)((e=>x(e,a.id)));return void 0===l||void 0===a?we().createElement(we().Fragment,null):we().createElement(we().Fragment,null,we().createElement(ke.CodingComponent,{exerciseObject:{startingCode:l,metadata:{startingCodeConfig:{options:ke.readonlyAdjustableHeightCodeOptions},answerCodeConfig:{options:r?ke.adjustableHeightCodeOptions:ke.readonlyAdjustableHeightCodeOptions}}},onAnswerChanges:e=>{n({...a,src:e.answer.src})},initialAnswer:{answer:{...a}}}),we().createElement(je,null,we().createElement(ft,{input:t(a.id,l,a)})),we().createElement(ot,{objects:i?i.outputs.map((e=>({output:e.output,type:e.type}))):[]}))}const Et={name:"code-tab",label:"Testing Code"};function wt(e){const t=(0,xe.useSelector)((t=>j(t,e.testingCode.id)));return we().createElement(we().Fragment,null,we().createElement("input",{type:"radio",name:"my-accordion-3"}),we().createElement("div",{className:"collapse-title text-xl font-medium "+(void 0===t?"bg-base-200":(null==t?void 0:t.result)?"bg-success":"bg-error")},""===e.testingCode.name?"New Test":e.testingCode.name))}function xt(e){const{executeTest:t}=(0,Ee.useContext)(ct);return we().createElement(yt,{icon:Xe.runIcon,execute:t,additionalLabel:e.additionalLabel,input:e.input})}function St(e){const{verifyTest:t}=(0,Ee.useContext)(ct);return we().createElement(yt,{icon:Xe.bugIcon,execute:n=>t({...n,cellId:e.input.cellId}),input:[e.input],additionalLabel:e.additionalLabel})}function Ot(e){const{removeTestCodeField:t,changeField:n}=(0,Ee.useContext)(Oe),r="instructor"===(0,xe.useSelector)((e=>z(e))),l=(0,xe.useSelector)((e=>A(e))),{createKernelExecution:a,createKernelTestVerification:i}={createKernelTestVerification:(e,t,...n)=>({referenceId:e,src:n.map((e=>e.src)).join("\r\n"),cellId:t}),createKernelExecution:(e,...t)=>[{referenceId:e,src:t.map((e=>e.src)).join("\r\n")}],createMultipleKernelExecution:(e,...t)=>e.map((e=>({referenceId:e.id,src:t.map((e=>e.src)).join("\r\n")+"\r\n"+e.src})))},o=(0,xe.useSelector)((t=>J(t,e.startingCodeId))),s=(0,xe.useSelector)((t=>q(t,e.cellId,null==l?void 0:l.username))),c=(0,xe.useSelector)((t=>J(t,e.solutionCodeId))),d=(0,xe.useSelector)((t=>x(t,e.testingCode.id)));return we().createElement("div",{className:"collapse-content bg-base-200 pt-4"},!e.testingCode.verified&&we().createElement(Ge,{name:e.testingCode.name,onNameChange:t=>n({...e.testingCode,name:t})}),we().createElement(Ne,{src:e.testingCode.src,language:e.testingCode.language,readonly:e.testingCode.verified||e.testingCode.createdBy!==(null==l?void 0:l.username),onChange:e.changeSrc}),we().createElement(ot,{objects:d?d.outputs.map((e=>({output:e.output,type:e.type}))):[]}),we().createElement(je,null,""!==e.testingCode.name&&!e.testingCode.verified&&e.testingCode.createdBy===(null==l?void 0:l.username)&&we().createElement(St,{input:i(e.testingCode.id,e.cellId,o,c,e.testingCode)}),e.testingCode.verified&&we().createElement(xt,{input:a(e.testingCode.id,o,r?c:s,e.testingCode)}),(r||!e.testingCode.verified)&&we().createElement(Fe,{className:"btn-error",icon:Xe.deleteIcon.svgstr,onClick:()=>t(e.cellId,e.testingCode.id)})))}function _t(e){const{changeField:t}=(0,Ee.useContext)(Oe),n=(0,xe.useSelector)((t=>J(t,e.testingCodeId))),r=(0,xe.useSelector)((e=>e.user.identity));return n.verified||n.createdBy===(null==r?void 0:r.username)?we().createElement("div",{className:"collapse collapse-arrow mb-2"},we().createElement(wt,{name:e.name,testingCode:n}),we().createElement(Ot,{solutionCodeId:e.solutionCodeId,testingCode:n,startingCodeId:e.startingCodeId,cellId:e.name,changeName:e=>t({...n,name:e}),changeSrc:e=>t({...n,src:e})})):we().createElement(we().Fragment,null)}function Ft(e){const t=(0,xe.useSelector)((t=>I(t,e.cellId).testingCodeIds)),n=(0,xe.useSelector)((t=>I(t,e.cellId).solutionCodeId)),r=(0,xe.useSelector)((t=>I(t,e.cellId).startingCodeId));return we().createElement("div",{className:"accordion"},t.map((t=>we().createElement(_t,{name:e.cellId,testingCodeId:t,solutionCodeId:n,startingCodeId:r}))))}function jt(e){const{addTestCodeField:t}=(0,Ee.useContext)(Oe),{createMultipleKernelExecution:n}={createKernelTestVerification:(e,t,...n)=>({referenceId:e,src:n.map((e=>e.src)).join("\r\n"),cellId:t}),createKernelExecution:(e,...t)=>[{referenceId:e,src:t.map((e=>e.src)).join("\r\n")}],createMultipleKernelExecution:(e,...t)=>e.map((e=>({referenceId:e.id,src:t.map((e=>e.src)).join("\r\n")+"\r\n"+e.src})))},r=(0,xe.useSelector)((e=>{var t;return null===(t=e.user.identity)||void 0===t?void 0:t.username})),l=(0,xe.useSelector)((t=>J(t,I(t,e.cellId).startingCodeId))),a=(0,xe.useSelector)((t=>J(t,I(t,e.cellId).solutionCodeId))),i=(0,xe.useSelector)((t=>q(t,e.cellId,r))),o=(0,m.createSelector)([I,e=>e,(e,t)=>t],((e,t)=>e.testingCodeIds.map((e=>J(t,e))))),s=(0,xe.useSelector)((t=>o(t,e.cellId))),c=(0,xe.useSelector)((e=>"instructor"===z(e)));return we().createElement(we().Fragment,null,we().createElement(Ft,{cellId:e.cellId}),we().createElement(je,null,we().createElement("button",{onClick:()=>t(e.cellId),className:"btn btn-light btn-sm"},we().createElement(Xe.LabIcon.resolveReact,{icon:Xe.addIcon})),we().createElement(xt,{input:n(s,l,c?a:i),additionalLabel:"All tests"})))}function Pt(e){const{createKernelExecution:t}={createKernelTestVerification:(e,t,...n)=>({referenceId:e,src:n.map((e=>e.src)).join("\r\n"),cellId:t}),createKernelExecution:(e,...t)=>[{referenceId:e,src:t.map((e=>e.src)).join("\r\n")}],createMultipleKernelExecution:(e,...t)=>e.map((e=>({referenceId:e.id,src:t.map((e=>e.src)).join("\r\n")+"\r\n"+e.src})))},{addStudentSolutionField:n,changeField:r}=(0,Ee.useContext)(Oe),l=(0,xe.useSelector)((t=>J(t,I(t,e.cellId).startingCodeId))),a=(0,xe.useSelector)((e=>{var t;return null===(t=e.user.identity)||void 0===t?void 0:t.username})),i=(0,xe.useSelector)((t=>q(t,e.cellId,a))),o=(0,xe.useSelector)((e=>x(e,i.id)));return void 0===i||void 0===l?(void 0!==l&&n(e.cellId,"code-solution"),we().createElement(we().Fragment,null)):we().createElement("div",{className:"puzzle-field puzzle-field--code"},we().createElement(ke.CodingComponent,{exerciseObject:{startingCode:l,metadata:{startingCodeConfig:{options:ke.readonlyAdjustableHeightCodeOptions}}},initialAnswer:{answer:i},onAnswerChanges:e=>r({...i,src:e.answer.src})}),we().createElement(je,null,we().createElement(ft,{input:t(l.id,l)})),we().createElement(ot,{objects:o?o.outputs.map((e=>({output:e.output,type:e.type}))):[]}))}function kt(e){return we().createElement("div",{role:"tablist",className:"tabs tabs-bordered"},we().createElement(pt,{checked:!0,cellId:e.cellId,...bt}),we().createElement(ht,{...bt,cellId:e.cellId},we().createElement(Pt,{cellId:e.cellId})),we().createElement(pt,{checked:!0,cellId:e.cellId,...gt}),we().createElement(ht,{...gt,cellId:e.cellId},we().createElement(It,{cellId:e.cellId})),we().createElement(pt,{cellId:e.cellId,...Ct}),we().createElement(ht,{cellId:e.cellId,...Ct},we().createElement(vt,{cellId:e.cellId})),we().createElement(pt,{cellId:e.cellId,...Et}),we().createElement(ht,{cellId:e.cellId,...Et},we().createElement(jt,{cellId:e.cellId})))}function Nt(e){return"instructor"===(0,xe.useSelector)((e=>z(e)))?we().createElement(Re,{label:"Coding Setup"},we().createElement(kt,{...e})):we().createElement(kt,{...e})}function Mt(e){const{addMultipleChoiceOption:t,changeCell:n,changeField:r,removeMultipleChoiceOption:l,swapPositionOfMultipleChoiceOption:a}=(0,Ee.useContext)(Oe),i=(0,xe.useSelector)((t=>I(t,e.cellId))),o=(0,xe.useSelector)((e=>W(e,i.options))),s=(e,t)=>{t?i.multi?n({...i,solutionOptions:[...i.solutionOptions,e]}):n({...i,solutionOptions:[e]}):n({...i,solutionOptions:i.solutionOptions.filter((t=>t!==e))})},c=o.map(((t,n)=>we().createElement(Ze,{content:t.src,index:n,maxIndex:i.options.length-1,onItemContentChange:e=>r({...t,src:e}),optionId:t.id,onSelectionChange:s,options:{multi:i.multi,randomOrder:i.random},remove:()=>l(e.cellId,t.id),swapPosition:(t,n)=>a(e.cellId,t,n)})));return we().createElement(et,{addMultipleChoiceOption:()=>t(e.cellId)},we().createElement($e,{label:"Configuration"},we().createElement(Qe,{label:"Multi Selection",onChange:e=>n({...i,multi:e}),value:i.multi}),we().createElement(Qe,{label:"Random Order",onChange:e=>n({...i,random:e}),value:i.randomOrder})),c)}const Tt=e=>{const{changeField:t,addStudentSolutionField:n}=(0,Ee.useContext)(Oe),r=(0,xe.useSelector)((e=>{var t;return null===(t=e.user.identity)||void 0===t?void 0:t.username})),l=(0,xe.useSelector)((t=>q(t,e.cellId,r))),a=(0,xe.useSelector)((t=>I(t,e.cellId))),i=(0,xe.useSelector)((e=>W(e,a.options)));return void 0===l?(n(e.cellId,"multiple-choice-solution"),we().createElement(we().Fragment,null)):we().createElement(nt,{answer:l.src,onAnswerChanges:e=>t({...l,src:e.answer}),items:i,options:{multi:a.multi,random:a.random,showSolution:a.showSolution,submitted:l.submitted},setSubmit:e=>t({...l,submitted:e}),solutionOptions:a.solutionOptions})},At=e=>{const t="instructor"===(0,xe.useSelector)((e=>z(e)));return we().createElement(we().Fragment,null,t?we().createElement(Mt,{cellId:e.cellId}):we().createElement(Tt,{cellId:e.cellId}))},zt=e=>{const{addStudentSolutionField:t,changeField:n}=(0,Ee.useContext)(Oe),r=(0,xe.useSelector)((e=>{var t;return null===(t=e.user.identity)||void 0===t?void 0:t.username})),l=(0,xe.useSelector)((t=>q(t,e.cellId,r))),a=(0,xe.useSelector)((t=>I(t,e.cellId).showSolution)),i=(0,xe.useSelector)((t=>J(t,I(t,e.cellId).solutionId)));return void 0===l?(t(e.cellId,"text-solution"),we().createElement(we().Fragment,null)):we().createElement(rt,{answer:l.src,onAnswerChanges:e=>n({...l,src:e.answer.src}),options:{showSolution:a,submitted:l.submitted},setSubmit:e=>n({...l,submitted:e}),solution:i.src})},Dt=e=>{const{changeField:t}=(0,Ee.useContext)(Oe),n=(0,xe.useSelector)((t=>I(t,e.cellId))),r=(0,xe.useSelector)((e=>J(e,n.solutionId)));return void 0===r?we().createElement(we().Fragment,null):we().createElement(tt,{src:r.src,onChange:e=>t({...r,src:e})})},Rt=e=>{const t="instructor"===(0,xe.useSelector)((e=>z(e)));return we().createElement(we().Fragment,null,t?we().createElement(Dt,{cellId:e.cellId}):we().createElement(zt,{cellId:e.cellId}))};function Kt(e){const t=(0,xe.useSelector)((t=>I(t,e.cellId).descriptionId)),n=(0,xe.useSelector)((t=>I(t,e.cellId).type)),r=(0,xe.useSelector)((t=>I(t,e.cellId).visible)),l="instructor"===(0,xe.useSelector)((e=>z(e)));return r||l?we().createElement(Me,{className:"ml-2 mr-2"},we().createElement(ut,{cellId:e.cellId,index:e.index}),we().createElement(Te,null,we().createElement(st,{fieldId:t}),"code-cell"===n&&we().createElement(Nt,{cellId:e.cellId}),"multiple-choice-cell"===n&&we().createElement(At,{cellId:e.cellId}),"text-cell"===n&&we().createElement(Rt,{cellId:e.cellId}))):we().createElement(we().Fragment,null)}function Ht(){const e=(0,xe.useSelector)((e=>(e=>e.cells.allIds)(e)));return we().createElement(we().Fragment,null,null==e?void 0:e.map(((e,t)=>we().createElement(Kt,{cellId:e,index:t}))))}function Lt(e){const t="instructor"===(0,xe.useSelector)((e=>z(e))),n=ge.instance.getFactoryNamings().map((t=>we().createElement("button",{type:"button",className:"btn join-item grow",onClick:()=>e.addCell(t.id)},t.name)));return we().createElement(we().Fragment,null,t&&we().createElement("div",{className:"join flex"},n))}class Vt extends a.ReactWidget{render(){return Ee.createElement(xe.Provider,{store:G},Ee.createElement(_e,{changeField:this._model.changeField.bind(this._model),deleteCell:this._model.deleteCell.bind(this._model),addFieldToPropertyArray:this._model.addFieldToPropertyArray.bind(this._model),removeFieldFromPropertyArray:this._model.removeFieldFromPropertyArray.bind(this._model),changeCell:this._model.changeCell.bind(this._model),swapCellPosition:this._model.swapCellPosition.bind(this._model),swapInPropertyArray:this._model.swapInPropertyArray.bind(this._model)},Ee.createElement(dt,{executeCode:e=>Ie.instance.executeCode(e,this._sessionContext),executeTest:e=>Ie.instance.executeTest(e,this._sessionContext),verifyTest:e=>Ie.instance.verifyTest(e,this._sessionContext)},Ee.createElement(Se,null),Ee.createElement(Ht,null),Ee.createElement(Lt,{addCell:this._model.addCell.bind(this._model)}))))}constructor(e){super(),Object.defineProperty(this,"_model",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_sessionContext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._sessionContext=e.sessionContext,this._model=e.model,this.addClass("jp-puzzle-panel"),e.ready.then((()=>{this.update()}))}dispose(){this.isDisposed||(ye.Signal.clearData(this),super.dispose())}}class Bt extends ve.DocumentWidget{constructor(e){console.log("creating puzzle doc widget"),super(e)}dispose(){this.content.dispose(),super.dispose()}}class Ut extends ve.ABCWidgetFactory{constructor(e){console.log("creating factory for puzzle doc"),super(e)}createNewWidget(e){return new Bt({context:e,content:new Vt(e)})}}var Jt=n(9943),Wt=n(1242);class qt{constructor(e){Object.defineProperty(this,"defaultKernelName",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"defaultKernelLanguage",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"sharedModel",{enumerable:!0,configurable:!0,writable:!0,value:Ce.create()}),Object.defineProperty(this,"_onSharedModelChanged",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{t.stateChange&&t.stateChange.forEach((e=>{"dirty"===e.name?this.dirty=e.newValue:e.oldValue!==e.newValue&&this.triggerStateChange({newValue:void 0,oldValue:void 0,...e})}))}}),Object.defineProperty(this,"_dirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDisposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_readOnly",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_collaborationEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_stateChanged",{enumerable:!0,configurable:!0,writable:!0,value:new ye.Signal(this)}),Object.defineProperty(this,"contentChanged",{enumerable:!0,configurable:!0,writable:!0,value:new ye.Signal(this)}),Object.defineProperty(this,"_identity",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{collaborationEnabled:t,sharedModel:n,identity:r}=e;this._identity=r,G.dispatch(T(r)),this._collaborationEnabled=!!t,this.sharedModel=n||Ce.create(),this.sharedModel.changed.connect(this._onSharedModelChanged)}get collaborative(){return this._collaborationEnabled}get dirty(){return this._dirty}set dirty(e){const t=this._dirty;e!==t&&(this._dirty=e,this.triggerStateChange({name:"dirty",oldValue:t,newValue:e}))}get isDisposed(){return this._isDisposed}get readOnly(){return this._readOnly}set readOnly(e){if(e===this._readOnly)return;const t=this._readOnly;this._readOnly=e,this.triggerStateChange({name:"readOnly",oldValue:t,newValue:e})}get clientId(){return this.sharedModel.awareness.clientID}addCell(e){var t,n;this.sharedModel.addCell(e,null!==(n=null===(t=this._identity)||void 0===t?void 0:t.username)&&void 0!==n?n:"")}changeField(e){this.sharedModel.changeField(e)}deleteCell(e){this.sharedModel.deleteCell(e)}changeCell(e){this.sharedModel.changeCell(e)}swapCellPosition(e,t){this.sharedModel.swapCellPosition(e,t)}addFieldToPropertyArray(e,t,n){var r,l;this.sharedModel.addFieldToPropertyArray(e,t,n,null!==(l=null===(r=this._identity)||void 0===r?void 0:r.username)&&void 0!==l?l:"")}removeFieldFromPropertyArray(e,t,n){this.sharedModel.removeFieldFromPropertyArray(e,t,n)}swapInPropertyArray(e,t,n,r){this.sharedModel.swapInPropertyArray(e,t,n,r)}getIdentity(){return this._identity}get stateChanged(){return this._stateChanged}dispose(){this._isDisposed||(this._isDisposed=!0,ye.Signal.clearData(this))}toString(){const e=this.sharedModel.cells,t={cells:null!=e?e:[]};return JSON.stringify(t,null,2)}fromString(e){}toJSON(){return JSON.parse(this.toString()||"null")}fromJSON(e){this.fromString(JSON.stringify(e))}initialize(){}triggerStateChange(e){this._stateChanged.emit(e)}}class Yt{constructor(e){Object.defineProperty(this,"collaborative",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_identity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_docManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._docManager=e.docManager,this._identity=e.identity}get name(){return"puzzle-model"}get contentType(){return"puzzledoc"}get fileFormat(){return"text"}get isDisposed(){return this._disposed}dispose(){this._disposed=!0}preferredLanguage(e){return""}createNew(e){return e.docManager=this._docManager,e.identity=this._identity,new qt(e)}}var Gt=n(8318),$t=n.n(Gt),Qt=n(5879),Xt=n.n(Qt),Zt=n(237),en=n.n(Zt),tn=n(4862),nn=n.n(tn),rn=n(1050),ln=n.n(rn),an=n(8495),on=n.n(an),sn=n(5210),cn={};cn.styleTagTransform=on(),cn.setAttributes=nn(),cn.insert=en().bind(null,"head"),cn.domAPI=Xt(),cn.insertStyleElement=ln(),$t()(sn.A,cn),sn.A&&sn.A.locals&&sn.A.locals;const dn="puzzle-editor",un=new i.Token("puzzleDocTracker");var mn;!function(e){e.createNew="jupyterpuzzle:create-new-puzzle-file"}(mn||(mn={}));const pn={id:"collab_learning_extension:plugin",description:"A Collaborative Learning Extension for Jupyter Notebook",autoStart:!0,requires:[l.ILayoutRestorer,Jt.IFileBrowserFactory,a.ICommandPalette,o.ILauncher,Wt.IDocumentManager],optional:[r.ICollaborativeDrive],provides:un,activate:(e,t,n,r,l,i,o)=>{const s=e.serviceManager.user;console.log("JupyterLab extension collab_learning_extension is activated!");const c=new a.WidgetTracker({namespace:"puzzle-documents"});if(t&&(console.log("reopen files"),t.restore(c,{command:"docmanager:open",args:e=>({path:e.context.path,factory:dn}),name:e=>e.context.path})),e.commands.addCommand(mn.createNew,{label:"New Puzzle File",caption:"Create a new Puzzle Playground",icon:e=>e.isPalette?void 0:Xe.fileIcon,execute:async t=>{var r;const l=t.cwd||(null===(r=n.tracker.currentWidget)||void 0===r?void 0:r.model.path);let a=await e.serviceManager.contents.newUntitled({path:l,type:"file",ext:".puzzle"});return a=await e.serviceManager.contents.save(a.path,{...a,format:"text",size:void 0,content:'{"cells": {"allIds": [],"byId": {}},"fields": { "byId": {},"allIds": []}}'}),e.commands.execute("docmanager:open",{path:a.path,factory:dn})}}),r.addItem({command:mn.createNew,category:""}),l.add({command:mn.createNew,category:"Other",rank:1}),e.docRegistry.addFileType({name:"puzzle",displayName:"Puzzle",mimeTypes:["text/json","application/json"],extensions:[".puzzle"],fileFormat:"text",contentType:"puzzledoc"}),!o)return void console.error("collaborative mode inactive");{const e=()=>Ce.create();o.sharedModelFactory.registerDocumentFactory("puzzledoc",e)}const d=new Yt({docManager:i,identity:s.identity});e.docRegistry.addModelFactory(d);const u=new Ut({name:dn,modelName:"puzzle-model",fileTypes:["puzzle"],defaultFor:["puzzle"],canStartKernel:!0,preferKernel:!0,shutdownOnClose:!0,autoStartDefault:!0});u.widgetCreated.connect(((e,t)=>{t.context.pathChanged.connect((()=>{c.save(t)})),c.add(t)})),e.docRegistry.addWidgetFactory(u)}}},5210:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(6551),l=n.n(r),a=n(1992),i=n.n(a)()(l());i.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};",""]);const o=i}}]);