"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8678],{58678:function(e,r,n){n.r(r),n.d(r,{default:function(){return D}});var t=n(28841),i=n(27378),o=n(6848),s=n(51365),a=n(90849),l=n(55732),c=n(97865),u=n(34707),f=n.n(u),d=n(34090),m=n(14633),h=n(78624),p=n(9408),x=n(90089),j=n(24246),y=["isRequired"],g=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,v=(0,t.Gpc)((function(e,r){var n=e.isRequired,o=void 0!==n&&n,s=(0,x.Z)(e,y),a=s.form.values.emails,l=(0,i.useState)(""),c=l[0],u=l[1],f=function(e){e.map((function(e){return e.trim()})).filter((function(e){return function(e){return g.test(e)}(e)&&!function(e){return a.includes(e)}(e)})).forEach((function(e){return s.push(e)})),u("")};return(0,j.jsxs)(t.NIc,{alignItems:"baseline",display:"inline-flex",isInvalid:!!s.form.errors[s.name],isRequired:o,children:[(0,j.jsx)(t.lXp,{fontSize:"md",htmlFor:"email",children:"Email"}),(0,j.jsxs)(t.gCW,{align:"flex-start",w:"inherit",children:[(0,j.jsx)(t.IIB,{autoComplete:"off",placeholder:"Type or paste email addresses separated by commas and press `Enter` or `Tab`...",onChange:function(e){u(e.target.value)},onKeyDown:function(e){["Enter","Tab",","].includes(e.key)&&(e.preventDefault(),f([c]))},onPaste:function(e){e.preventDefault();var r=e.clipboardData.getData("text").split(",");f(r)},ref:r,size:"sm",type:"email",value:c}),(0,j.jsx)(t.J1D,{children:s.form.errors[s.name]}),a.length>0&&(0,j.jsx)(t.Eq9,{spacing:1,mb:3,pt:"8px",children:a.map((function(e,r){return(0,j.jsxs)(t.Vp9,{borderRadius:"full",backgroundColor:"primary.400",color:"white",size:"sm",variant:"solid",children:[(0,j.jsx)(t.Sn0,{children:e}),(0,j.jsx)(t.SD9,{onClick:function(){s.remove(r)}})]},e)}))})]})]})}));function b(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function O(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?b(Object(n),!0).forEach((function(r){(0,a.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var C=m.Ry().shape({emails:m.IX(m.Z_()).when(["notify"],{is:!0,then:m.IX(m.Z_()).min(1,"Must enter at least one valid email").label("Email")}),notify:m.O7(),minErrorCount:m.Rx().required()}),w=function(){var e=(0,t.qY0)(),r=e.isOpen,n=e.onOpen,o=e.onClose,a=(0,i.useState)({emails:[],notify:!1,minErrorCount:1}),u=a[0],m=a[1],x=(0,i.useRef)(null),y=(0,p.VY)(),g=y.errorAlert,b=y.successAlert,w=(0,i.useState)(!0),S=w[0],E=w[1],z=(0,s.tE)(void 0,{skip:S}).data,_=(0,s.SC)(),D=(0,c.Z)(_,1)[0],P=function(){var e=(0,l.Z)(f().mark((function e(r,n){var t;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setSubmitting(!0),e.next=3,D({email_addresses:r.emails,notify_after_failures:r.notify?r.minErrorCount:0});case 3:"error"in(t=e.sent)?g((0,h.e$)(t.error),"Configure alerts and notifications has failed to save due to the following:"):b("Configure alerts and notifications saved successfully."),n.setSubmitting(!1),o();case 7:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){r&&E(!1),z&&m({emails:z.email_addresses,notify:0!==z.notify_after_failures,minErrorCount:z.notify_after_failures})}),[z,r]),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(t.sNh,{onClick:n,_focus:{bg:"gray.100",color:"complimentary.500"},children:"Configure alerts"}),(0,j.jsx)(d.J9,{enableReinitialize:!0,initialValues:u,onSubmit:P,validationSchema:C,children:function(e){return(0,j.jsxs)(t.dys,{isOpen:r,placement:"right",initialFocusRef:x,onClose:function(){e.resetForm(),o()},size:"lg",children:[(0,j.jsx)(t.P1B,{}),(0,j.jsxs)(t.scA,{color:"gray.900",children:[(0,j.jsx)(t.cCv,{}),(0,j.jsxs)(t.OXI,{color:"gray.900",children:[(0,j.jsx)(t.xvT,{fontSize:"2xl",fontWeight:"normal",mb:4,children:"Configure alerts and notifications"}),(0,j.jsx)(t.xuv,{mt:"26px",children:(0,j.jsx)(t.xvT,{fontSize:"md",fontWeight:"normal",children:"Setup your alerts to send you a notification when there are any processing failures. You can also setup a threshold for connector failures for Fides to notify you after X amount of failures have occurred."})})]}),(0,j.jsx)(t.Ng0,{mt:"20px",children:(0,j.jsxs)(d.l0,{id:"configure-alerts-form",noValidate:!0,children:[(0,j.jsx)(t.xvT,{fontSize:"md",children:"Contact details"}),(0,j.jsxs)(t.gCW,{align:"stretch",gap:"29px",mt:"14px",children:[(0,j.jsx)(t.Ugi,{children:(0,j.jsx)(d.F2,{name:"emails",render:function(r){return(0,j.jsx)(v,O(O({},r),{},{isRequired:e.values.notify,ref:x}))}})}),(0,j.jsx)(t.Ugi,{children:(0,j.jsx)(d.gN,{id:"notify",name:"notify",children:function(r){var n=r.field;return(0,j.jsxs)(t.NIc,{alignItems:"center",display:"flex",mt:"45px",children:[(0,j.jsx)(t.lXp,{fontSize:"md",mb:"0",children:"Notify me immediately if there are any DSR processing errors"}),(0,j.jsx)(t.rsf,O(O({},n),{},{colorScheme:"secondary",isChecked:e.values.notify,onChange:function(r){n.onChange(r),e.setFieldValue("minErrorCount",1),r.target.checked||setTimeout((function(){e.setFieldTouched("emails",!1)}),0)}}))]})}})})]}),(0,j.jsx)(t.xvT,{color:"#757575",fontSize:"sm",mt:"11px",children:"If selected, then Fides will notify you by your chosen method of communication every time the system encounters a data subject request processing error. You can turn this off anytime and setup a more suitable notification method below if you wish."}),e.values.notify&&(0,j.jsx)(t.Ugi,{mt:"34px",children:(0,j.jsx)(d.gN,{id:"minErrorCount",name:"minErrorCount",children:function(r){var n=r.field,i=r.meta;return(0,j.jsxs)(t.NIc,{alignItems:"center",display:"flex",isInvalid:!(!i.error||!i.touched),isRequired:!0,children:[(0,j.jsx)(t.xvT,{children:"Notify me after"}),(0,j.jsxs)(t.Y2U,{allowMouseWheel:!0,color:"gray.700",defaultValue:e.values.minErrorCount||1,min:1,ml:"8px",mr:"8px",onChange:function(r,n){e.setFieldValue("minErrorCount",n)},size:"sm",w:"80px",children:[(0,j.jsx)(t.zuI,O({},n)),(0,j.jsxs)(t.FiK,{children:[(0,j.jsx)(t.WQu,{}),(0,j.jsx)(t.Y_d,{})]})]}),(0,j.jsx)(t.xvT,{children:"DSR processing errors "})]})}})})]})}),(0,j.jsx)(t.zeN,{justifyContent:"flex-start",children:(0,j.jsxs)(t.hE2,{size:"sm",spacing:"8px",variant:"outline",children:[(0,j.jsx)(t.zxk,{onClick:function(){e.resetForm(),o()},variant:"outline",children:"Cancel"}),(0,j.jsx)(t.zxk,{bg:"primary.800",color:"white",form:"configure-alerts-form",isDisabled:e.isSubmitting,isLoading:e.isSubmitting,loadingText:"Submitting",size:"sm",variant:"solid",type:"submit",_active:{bg:"primary.500"},_hover:{bg:"primary.400"},children:"Save"})]})})]})]})}})]})};function S(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function E(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?S(Object(n),!0).forEach((function(r){(0,a.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var z=function(e){var r=e.menuProps;return(0,j.jsx)(t.xuv,{children:(0,j.jsxs)(t.v2r,E(E({},r),{},{children:[(0,j.jsx)(t.j2t,{as:t.zxk,fontWeight:"normal",rightIcon:(0,j.jsx)(t.mCO,{}),size:"sm",variant:"outline",_active:{bg:"none"},_hover:{bg:"none"},children:"More"}),(0,j.jsx)(t.qyq,{fontSize:"sm",children:(0,j.jsx)(w,{})})]}))})},_=n(30199),D=function(){var e=(0,o.C)(s.fe).errorRequests;return(0,j.jsxs)(t.hE2,{flexDirection:"row",size:"sm",spacing:"8px",variant:"outline",children:[(null===e||void 0===e?void 0:e.length)>0&&(0,j.jsx)(_.Z,{}),(0,j.jsx)(z,{})]})}}}]);