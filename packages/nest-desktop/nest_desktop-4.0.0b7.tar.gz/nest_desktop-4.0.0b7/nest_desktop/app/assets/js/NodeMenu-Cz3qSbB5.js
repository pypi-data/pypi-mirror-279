import{d as I,N as O,M as P,b3 as R,o as s,n as m,w as o,a as t,c as r,g,i as v,b as u,cf as x,aW as N,j as w,f as d,v as c,F as S,r as b,P as T,cC as y,V as f,s as U,cA as A,c2 as J,l as E,O as $,h as F,aV as G,y as H,A as q,cB as K}from"./index-lT0LPxUj.js";import{_ as Q}from"./ModelDoc-1guyb5qd.js";import{u as X}from"./networkGraphStore-DCNH56J4.js";const Y={key:0},Z={key:1},ee={key:2},te={key:3},ne=I({__name:"NodeMenu",props:{node:{}},setup(z){const k=X(),D=z,e=O(()=>D.node),n=P({content:void 0,dialog:!1,show:!1,spatialNode:!1}),L=[{icon:"mdi:mdi-reload",iconClass:"mdi-flip-h",id:"resetParams",onClick:()=>{e.value.resetParams(),p()},append:!1,show:()=>!0,title:"Reset all parameters"},{icon:"mdi:mdi-axis-arrow",iconClass:"",id:"nodeSpatial",input:"switch",onClick:()=>{e.value.toggleSpatial()},show:()=>!e.value.model.isRecorder,title:"Toggle spatial mode",value:"spatialNode"},{icon:"mdi:mdi-format-color-fill",iconClass:"",id:"nodeColor",onClick:()=>{n.content="nodeColor",window.dispatchEvent(new Event("resize"))},append:!0,show:()=>!0,title:"Colorize node"},{icon:"mdi:mdi-information-outline",iconClass:"",id:"modelDoc",onClick:()=>{n.dialog=!0},show:()=>e.value.modelId!=="voltmeter",title:"Model documentation"},{icon:"mdi:mdi-content-copy",iconClass:"",id:"nodeClone",onClick:()=>{const l=JSON.parse(JSON.stringify(e.value.toJSON()));l.view&&(l.view.position.x+=50,l.view.color=void 0),e.value.nodes.addNode(l),e.value.changes(),p()},show:()=>!0,title:"Clone node"},{icon:"mdi:mdi-download",iconClass:"",id:"eventsExport",onClick:()=>{n.content="eventsExport"},show:()=>e.value.model.isRecorder&&e.value.activity&&e.value.activity.hasEvents,title:"Export events",append:!0},{icon:"mdi:mdi-trash-can-outline",iconClass:"",id:"nodeDelete",onClick:()=>{K({title:"Delete node?",text:"Are you sure to delete node?",buttons:[{title:"no",key:"no"},{title:"yes",key:"yes"}]}).then(l=>{l==="yes"&&e.value.remove()})},show:()=>!0,title:"Delete node"}],V=()=>{var l;e.value.changes(),G(()=>{e.value.nodes.updateRecordsColor()}),(l=k.state.graph)==null||l.updateHash()},M=()=>{e.value.view.color="",V()},_=(l="json")=>{var i,a;l==="json"?(i=e.value.activity)==null||i.exportEvents():l==="csv"&&((a=e.value.activity)==null||a.exportEventsCSV()),p()},W=()=>{e.value&&(n.spatialNode=e.value.spatial.hasPositions)},j=l=>{var i;l!=null&&(e.value.view.state.synWeights=l,e.value.changes(),(i=k.state.graph)==null||i.render())},h=()=>{n.content=void 0},p=()=>{n.content=void 0,n.show=!1};return R(()=>{p(),W()}),(l,i)=>(s(),m(F,{"close-on-content-click":!1,activator:"parent",modelValue:n.show,"onUpdate:modelValue":i[3]||(i[3]=a=>n.show=a)},{default:o(()=>[t($,{flat:"",style:{"min-width":"300px"}},{default:o(()=>[n.content==null?(s(),r("span",Y,[t(g,{density:"compact"},{default:o(()=>[e.value.model.isRecorder?c("",!0):(s(),m(v,{key:0},{prepend:o(()=>[t(u,{icon:"mdi:mdi-contrast"})]),append:o(()=>[t(x,{class:N([{"text-red":e.value.view.state.synWeights==="inhibitory"},"pl-2"]),indeterminate:!e.value.view.state.synWeights,"model-value":e.value.view.state.synWeights,"onUpdate:modelValue":j,color:"nest-project",density:"compact","false-icon":"mdi:mdi-minus-circle","false-value":"inhibitory","hide-details":"",inset:"","true-icon":"mdi:mdi-plus-circle","true-value":"excitatory"},null,8,["class","indeterminate","model-value"])]),default:o(()=>[t(w,null,{default:o(()=>[d("Set all synaptic weights")]),_:1})]),_:1})),(s(),r(S,null,b(L,(a,C)=>H(t(v,{key:C,title:a.title,onClick:a.onClick},{append:o(()=>[a.append?(s(),m(u,{key:0,icon:"mdi:mdi-menu-right",size:"small"})):c("",!0)]),prepend:o(()=>[t(u,{class:N(a.iconClass),icon:a.icon},null,8,["class","icon"])]),_:2},1032,["title","onClick"]),[[q,a.show()]])),64))]),_:1})])):c("",!0),n.content==="eventsExport"?(s(),r("span",Z,[t(T,{class:"py-1 px-0"},{default:o(()=>[t(g,{dense:""},{default:o(()=>[t(v,{onClick:i[0]||(i[0]=a=>_("json"))},{prepend:o(()=>[t(u,{icon:"mdi:mdi-code-json"})]),default:o(()=>[t(w,null,{default:o(()=>[d("Export events to JSON file")]),_:1})]),_:1}),t(v,{onClick:i[1]||(i[1]=a=>_("csv"))},{prepend:o(()=>[t(u,{icon:"mdi:mdi-file-delimited-outline"})]),default:o(()=>[t(w,null,{default:o(()=>[d("Export events to CSV file")]),_:1})]),_:1})]),_:1})]),_:1}),t(y,null,{default:o(()=>[t(f,{onClick:h,"prepend-icon":"mdi:mdi-menu-left",size:"small",variant:"text"},{default:o(()=>[d(" back ")]),_:1})]),_:1})])):c("",!0),U("span",null,[t(A,{value:n.dialog,width:"80%"},{default:o(()=>[t(Q,{id:e.value.modelId},null,8,["id"])]),_:1},8,["value"])]),n.content==="nodeColor"?(s(),r("span",ee,[t(J,{"onUpdate:modelValue":[V,i[2]||(i[2]=a=>e.value.view.color=a)],flat:"","show-swatches":"",elevation:"0",modelValue:e.value.view.color},null,8,["modelValue"]),t(y,null,{default:o(()=>[t(f,{onClick:h,"prepend-icon":"mdi:mdi-menu-left",size:"small",variant:"text"},{default:o(()=>[d(" back ")]),_:1}),t(E),t(f,{onClick:M,size:"small",variant:"outlined"},{default:o(()=>[d(" reset ")]),_:1})]),_:1})])):c("",!0),n.content==="synWeights"?(s(),r("span",te,[(s(!0),r(S,null,b(e.value.connections,(a,C)=>(s(),m(x,{key:C,label:a.synapse.weightLabel,"false-value":"inhibitory","true-value":"excitatory",modelValue:a.synapse.weightLabel,"onUpdate:modelValue":B=>a.synapse.weightLabel=B},null,8,["label","modelValue","onUpdate:modelValue"]))),128)),t(y,null,{default:o(()=>[t(f,{onClick:h,"prepend-icon":"mdi:mdi-menu-left",size:"small",variant:"text"},{default:o(()=>[d(" back ")]),_:1}),t(E)]),_:1})])):c("",!0)]),_:1})]),_:1},8,["modelValue"]))}});export{ne as _};
