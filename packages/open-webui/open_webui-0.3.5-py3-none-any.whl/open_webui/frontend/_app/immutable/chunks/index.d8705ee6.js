import"./sha256.65a6c54a.js";let p;const F=new Uint8Array(16);function v(){if(!p&&(p=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!p))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return p(F)}const a=[];for(let t=0;t<256;++t)a.push((t+256).toString(16).slice(1));function D(t,e=0){return a[t[e+0]]+a[t[e+1]]+a[t[e+2]]+a[t[e+3]]+"-"+a[t[e+4]]+a[t[e+5]]+"-"+a[t[e+6]]+a[t[e+7]]+"-"+a[t[e+8]]+a[t[e+9]]+"-"+a[t[e+10]]+a[t[e+11]]+a[t[e+12]]+a[t[e+13]]+a[t[e+14]]+a[t[e+15]]}const C=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),I={randomUUID:C};function U(t,e,n){if(I.randomUUID&&!e&&!t)return I.randomUUID();t=t||{};const s=t.random||(t.rng||v)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,e){n=n||0;for(let o=0;o<16;++o)e[n+o]=s[o];return e}return D(s)}const A=t=>t.replace(/<\|[a-z]*$/,"").replace(/<\|[a-z]+\|$/,"").replace(/<$/,"").replaceAll(/<\|[a-z]+\|>/g," ").replaceAll("<","&lt;").replaceAll(">","&gt;").trim(),N=t=>t.replaceAll("&lt;","<").replaceAll("&gt;",">"),$=t=>{let e="";return new TransformStream({transform(n,s){e+=n;const o=e.split(t);o.slice(0,-1).forEach(r=>s.enqueue(r)),e=o[o.length-1]},flush(n){e&&n.enqueue(e)}})},z=t=>{const e={messages:{},currentId:null};let n=null,s=null;for(const o of t)s=U(),n!==null&&(e.messages[n].childrenIds=[...e.messages[n].childrenIds,s]),e.messages[s]={...o,id:s,parentId:n,childrenIds:[]},n=s;return e.currentId=s,e},S=()=>{const t=document.createElement("canvas"),e=t.getContext("2d");t.height=1,t.width=1;const n=new ImageData(t.width,t.height),s=n.data;for(let r=0;r<n.data.length;r+=1)r%4!==3?s[r]=Math.floor(256*Math.random()):s[r]=255;e.putImageData(n,0,0);const o=e.getImageData(0,0,t.width,t.height).data;for(let r=0;r<o.length;r+=1)if(o[r]!==s[r])return console.log("canvasPixelTest: Wrong canvas pixel RGB value detected:",o[r],"at:",r,"expected:",s[r]),console.log("canvasPixelTest: Canvas blocking or spoofing is likely"),!1;return!0},P=t=>{const e=document.createElement("canvas"),n=e.getContext("2d");if(e.width=100,e.height=100,!S())return console.log("generateInitialsImage: failed pixel test, fingerprint evasion is likely. Using default image."),"/user.png";n.fillStyle="#F39C12",n.fillRect(0,0,e.width,e.height),n.fillStyle="#FFFFFF",n.font="40px Helvetica",n.textAlign="center",n.textBaseline="middle";const s=t.trim(),o=s.length>0?s[0]+(s.split(" ").length>1?s[s.lastIndexOf(" ")+1]:""):"";return n.fillText(o.toUpperCase(),e.width/2,e.height/2),e.toDataURL()},_=async t=>{let e=!1;if(!navigator.clipboard){const n=document.createElement("textarea");n.value=t,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();try{const o=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+o),e=!0}catch(s){console.error("Fallback: Oops, unable to copy",s)}return document.body.removeChild(n),e}return e=await navigator.clipboard.writeText(t).then(()=>(console.log("Async: Copying to clipboard was successful!"),!0)).catch(n=>(console.error("Async: Could not copy text: ",n),!1)),e},L=(t,e)=>e==="0.0.0"?!1:e.localeCompare(t,void 0,{numeric:!0,sensitivity:"case",caseFirst:"upper"})<0,O=t=>{const e=/\[([^\]]+)\]/g,n=[];let s;for(;(s=e.exec(t))!==null;)n.push({word:s[1],startIndex:s.index,endIndex:e.lastIndex-1});return n},V=t=>{const e=t.split(" "),n=e.findIndex(o=>o.startsWith("#"));return n!==-1&&e.splice(n,1),e.join(" ")},Y=t=>t.toLowerCase().replace(/[^\w\s]/g,"").replace(/\s+/g,"-"),k=t=>"mapping"in t[0]?"openai":"webui",H=async(t=!1)=>{const e=await new Promise((o,r)=>{navigator.geolocation.getCurrentPosition(o,r)}).catch(o=>{throw console.error("Error getting user location:",o),o});if(!e)return"Location not available";const{latitude:n,longitude:s}=e.coords;return t?{latitude:n,longitude:s}:`${n.toFixed(3)}, ${s.toFixed(3)} (lat, long)`},T=t=>{var l,d,g,c,f,y,w,x;const e=t.mapping,n=[];let s="",o=null;for(let u in e){const i=e[u];s=u;try{if(n.length==0&&(i.message==null||((l=i.message.content.parts)==null?void 0:l[0])==""&&i.message.content.text==null))continue;{const h={id:u,parentId:o,childrenIds:i.children||[],role:((g=(d=i.message)==null?void 0:d.author)==null?void 0:g.role)!=="user"?"assistant":"user",content:((y=(f=(c=i.message)==null?void 0:c.content)==null?void 0:f.parts)==null?void 0:y[0])||((x=(w=i.message)==null?void 0:w.content)==null?void 0:x.text)||"",model:"gpt-3.5-turbo",done:!0,context:null};n.push(h),o=s}}catch(h){console.log("Error with",i,`
Error:`,h)}}let r={};return n.forEach(u=>r[u.id]=u),{history:{currentId:s,messages:r},models:["gpt-3.5-turbo"],messages:n,options:{},timestamp:t.create_time,title:t.title??"New Chat"}},E=t=>{const e=t.messages;if(e.length===0||e[e.length-1].childrenIds.length!==0||e[0].parentId!==null)return!1;for(let o of e)if(typeof o.content!="string")return!1;return!0},j=t=>{const e=[];let n=0;for(let s of t){const o=T(s);E(o)?e.push({id:s.id,user_id:"",title:s.title,chat:o,timestamp:s.timestamp}):n++}return console.log(n,"Conversations could not be imported"),e},W=t=>{let e;try{e=new URL(t)}catch{return!1}return e.protocol==="http:"||e.protocol==="https:"},R=t=>{const e=/[\uD800-\uDBFF][\uDC00-\uDFFF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g;return t.replace(e,"")},M=t=>t.split(new RegExp("(?<=[.!?])\\s+")).map(n=>R(n.trim())).filter(n=>n!==""),q=t=>M(t).reduce((e,n)=>{const s=e.length-1;if(s>=0){const o=e[s];o.split(/\s+/).length<2?e[s]=o+" "+n:e.push(n)}else e.push(n);return e},[]),B=(t,e)=>new File([t],e,{type:t.type}),G=(t,e,n)=>{const s=new Date,o=s.getFullYear()+"-"+String(s.getMonth()+1).padStart(2,"0")+"-"+String(s.getDate()).padStart(2,"0"),r=s.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0});return t=t.replace("{{CURRENT_DATETIME}}",`${o} ${r}`),t=t.replace("{{CURRENT_DATE}}",o),t=t.replace("{{CURRENT_TIME}}",r),e&&(t=t.replace("{{USER_NAME}}",e)),n&&(t=t.replace("{{USER_LOCATION}}",n)),t},J=t=>{const e=Math.floor(t/1e9%60),n=Math.floor(t/6e10%60),s=Math.floor(t/36e11%24),o=[];return e>=0&&o.push(`${e}s`),n>0&&o.push(`${n}m`),s>0&&o.push(`${s}h`),o.reverse().join(" ")},K=t=>{const e=new Date,n=new Date(t*1e3),o=(e.getTime()-n.getTime())/(1e3*3600*24),r=e.getDate(),m=e.getMonth(),l=e.getFullYear(),d=n.getDate(),g=n.getMonth(),c=n.getFullYear();return l===c&&m===g&&r===d?"Today":l===c&&m===g&&r-d===1?"Yesterday":o<=7?"Previous 7 days":o<=30?"Previous 30 days":l===c?n.toLocaleString("default",{month:"long"}):n.getFullYear().toString()};export{_ as a,L as b,S as c,H as d,k as e,j as f,P as g,O as h,W as i,B as j,q as k,z as l,A as m,J as n,M as o,G as p,N as q,V as r,$ as s,Y as t,K as u,U as v,D as w};
//# sourceMappingURL=index.d8705ee6.js.map
