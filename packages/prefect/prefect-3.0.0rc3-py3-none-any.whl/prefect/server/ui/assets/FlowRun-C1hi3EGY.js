import{d as T,aF as $,ae as y,f as p,o as n,p as N,m,j as b,k as e,bp as z,c as u,bq as D,a as i,br as q,bs as A,bt as G,az as J,W as L,bu as O,an as Q,bv as W,bw as H,bx as Y,by as K,g as r,h as R,u as M,ah as F,bz as X,bA as Z,bB as ee,bC as le,bD as te,bE as se,bF as ae,bG as ne,bH as S,a5 as oe,bo as j,bI as ue}from"./index-Cjd-zuQH.js";import{u as re}from"./usePageTitle-BFRz6fNu.js";const ie={class:"flow-run-graphs__graph-panel-container"},fe={class:"flow-run-graphs__graphs"},ce={class:"flow-run-graphs__panel p-background"},pe=T({__name:"FlowRunGraphs",props:{flowRun:{}},setup(U){const g=$(),_=y(),l=y(!1),s=y(null),k=p(()=>{var f,t;return{root:{"flow-run-graphs--fullscreen":l.value,"flow-run-graphs--show-panel":((f=s.value)==null?void 0:f.kind)==="task-run"||((t=s.value)==null?void 0:t.kind)==="flow-run"}}}),d=async({nodeId:f,since:t,until:c})=>{const v={anyResource:{id:[`prefect.flow-run.${f}`]},event:{excludePrefix:["prefect.log.write","prefect.task-run."]},occurred:{since:t,until:c}},{events:w}=await g.events.getEvents(v);return w};return(f,t)=>{var c,v,w;return n(),N("div",{class:J(["flow-run-graphs",k.value.root])},[m("div",ie,[m("div",fe,[b(e(z),{fullscreen:l.value,"onUpdate:fullscreen":t[0]||(t[0]=a=>l.value=a),viewport:_.value,"onUpdate:viewport":t[1]||(t[1]=a=>_.value=a),selected:s.value,"onUpdate:selected":t[2]||(t[2]=a=>s.value=a),"flow-run":f.flowRun,"fetch-events":d,class:"flow-run-graphs__flow-run"},null,8,["fullscreen","viewport","selected","flow-run"])]),m("div",ce,[((c=s.value)==null?void 0:c.kind)==="task-run"||((v=s.value)==null?void 0:v.kind)==="flow-run"?(n(),u(e(D),{key:0,selection:s.value,"onUpdate:selection":t[3]||(t[3]=a=>s.value=a),floating:l.value},null,8,["selection","floating"])):i("",!0)])]),s.value&&s.value.kind==="artifacts"?(n(),u(e(q),{key:0,selection:s.value,"onUpdate:selection":t[4]||(t[4]=a=>s.value=a)},null,8,["selection"])):i("",!0),((w=s.value)==null?void 0:w.kind)==="state"?(n(),u(e(A),{key:1,selection:s.value,"onUpdate:selection":t[5]||(t[5]=a=>s.value=a)},null,8,["selection"])):i("",!0),b(e(G),{selection:s.value,"onUpdate:selection":t[6]||(t[6]=a=>s.value=a)},null,8,["selection"])],2)}}}),we=T({__name:"FlowRun",setup(U){const g=M(),_=L("flowRunId"),{flowRun:l,subscription:s}=O(_,{interval:5e3}),k=p(()=>{var o;return F(((o=l.value)==null?void 0:o.parameters)??{})}),d=p(()=>{var o;return(o=l.value)!=null&&o.stateType?X(l.value.stateType):!0}),f=p(()=>{var o;return F(((o=l.value)==null?void 0:o.jobVariables)??{})}),t=p(()=>[{label:"Logs"},{label:"Task Runs",hidden:d.value},{label:"Subflow Runs",hidden:d.value},{label:"Results",hidden:d.value},{label:"Artifacts",hidden:d.value},{label:"Details"},{label:"Parameters"},{label:"Job Variables"}]),c=Q("tab","Logs"),{tabs:v}=W(t,c),w=p(()=>[_.value]),{filter:a}=H({flowRuns:{parentFlowRunId:w}});function B(){g.push(j.runs())}const C=p(()=>{var o;return(o=l.value)==null?void 0:o.stateType});Y(C);const E=p(()=>l.value?`Flow Run: ${l.value.name}`:"Flow Run");return re(E),K(()=>{s.error&&ue(s.error).isInRange("clientError")&&g.replace(j[404]())}),(o,h)=>{const x=R("p-code-highlight"),I=R("p-tabs"),P=R("p-layout-default");return n(),u(P,{class:"flow-run"},{header:r(()=>[e(l)?(n(),u(e(Z),{key:0,"flow-run-id":e(l).id,onDelete:B},null,8,["flow-run-id"])):i("",!0)]),default:r(()=>[e(l)&&!d.value?(n(),u(pe,{key:0,"flow-run":e(l)},null,8,["flow-run"])):i("",!0),b(I,{selected:e(c),"onUpdate:selected":h[0]||(h[0]=V=>oe(c)?c.value=V:null),tabs:e(v)},{details:r(()=>[e(l)?(n(),u(e(ee),{key:0,"flow-run":e(l)},null,8,["flow-run"])):i("",!0)]),logs:r(()=>[e(l)?(n(),u(e(le),{key:0,"flow-run":e(l)},null,8,["flow-run"])):i("",!0)]),results:r(()=>[e(l)?(n(),u(e(te),{key:0,"flow-run":e(l)},null,8,["flow-run"])):i("",!0)]),artifacts:r(()=>[e(l)?(n(),u(e(se),{key:0,"flow-run":e(l)},null,8,["flow-run"])):i("",!0)]),"task-runs":r(()=>[e(l)?(n(),u(e(ae),{key:0,"flow-run-id":e(l).id},null,8,["flow-run-id"])):i("",!0)]),"subflow-runs":r(()=>[b(e(ne),{filter:e(a)},null,8,["filter"])]),parameters:r(()=>[e(l)?(n(),u(e(S),{key:0,"text-to-copy":k.value},{default:r(()=>[b(x,{lang:"json",text:k.value,class:"flow-run__parameters"},null,8,["text"])]),_:1},8,["text-to-copy"])):i("",!0)]),"job-variables":r(()=>[e(l)?(n(),u(e(S),{key:0,"text-to-copy":f.value},{default:r(()=>[b(x,{lang:"json",text:f.value,class:"flow-run__job-variables"},null,8,["text"])]),_:1},8,["text-to-copy"])):i("",!0)]),_:1},8,["selected","tabs"])]),_:1})}}});export{we as default};
//# sourceMappingURL=FlowRun-C1hi3EGY.js.map
