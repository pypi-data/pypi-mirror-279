"use strict";(self.webpackChunkjupyterlab_autoversion=self.webpackChunkjupyterlab_autoversion||[]).push([[871],{476:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AUTOVERSION_LABEL=t.AUTOVERSION_COMMAND=t.AUTOVERSION_CAPTION=void 0,t.AUTOVERSION_COMMAND="notebook:autoversion",t.AUTOVERSION_CAPTION="Restore previous version of notebook",t.AUTOVERSION_LABEL="autoversion"},7400:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.autoversionIcon=void 0;var n,a=o(7209),i=(n=o(1309))&&n.__esModule?n:{default:n};t.autoversionIcon=new a.LabIcon({name:"jupyterlab_autoversion",svgstr:i.default})},8509:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AutoversionExtension=void 0,t._activate=u,t.default=void 0;var n=o(1381),a=o(3605),i=o(3918),s=o(9012),r=o(8885),l=o(476),c=o(7400);o(8665);class d{commands;constructor(e){this.commands=e}createNew(e){const t=new n.ToolbarButton({className:"autoversionButton",tooltip:l.AUTOVERSION_CAPTION,icon:c.autoversionIcon,onClick:()=>{this.commands.execute(l.AUTOVERSION_COMMAND)}});return e.toolbar.insertAfter("restart-and-run",l.AUTOVERSION_LABEL,t),new s.DisposableDelegate((()=>{t.dispose()}))}}function u(e,t,o){const{commands:n}=e;e.docRegistry.addWidgetExtension("Notebook",new d(n)),n.addCommand(l.AUTOVERSION_COMMAND,{caption:l.AUTOVERSION_CAPTION,execute:async()=>{const n=t.currentWidget;n&&(await e.commands.execute("docmanager:save"),(0,r.autoversion)(e,o,n.context))},icon:c.autoversionIcon,isEnabled:()=>t&&void 0!==t.currentWidget&&null!==t.currentWidget,label:l.AUTOVERSION_CAPTION}),console.log("JupyterLab extension jupyterlab_autoversion is activated!")}t.AutoversionExtension=d;const v={activate:u,autoStart:!0,id:"jupyterlab_autoversion",requires:[a.INotebookTracker,i.IRenderMimeRegistry]};t.default=v},8885:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AutoversionWidget=void 0,t.autoversion=function(e,t,o){const{model:a}=o,i=a.metadata.autoversion||"";(0,n.showDialog)({body:new c(e,o,i,o.path),buttons:[n.Dialog.cancelButton(),n.Dialog.okButton({label:"Diff"}),n.Dialog.okButton({label:"Ok"})],focusNodeSelector:"input",title:"Autoversion:"}).then((n=>{if("Ok"===n.button.label){const e=n.value.split(",");d(0,o,e[2],e[3])}else if("Diff"===n.button.label){const a=n.value.split(",");u(e,t,o,a[2],a[3])}}))},t.diff=u,t.revision=d;var n=o(1381),a=o(2403),i=o(5256),s=o(2679),r=o(689),l=o(4220);o(8665);class c extends i.Widget{constructor(e,t,o,n){const i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column";const s=document.createElement("option");s.selected=!1,s.disabled=!0,s.hidden=!1,s.style.display="none",s.value="";const r=document.createElement("select");r.appendChild(s);const l=a.ServerConnection.makeSettings();a.ServerConnection.makeRequest(`${l.baseUrl}autoversion/get?id=${o}&path=${n}`,{},l).then((async e=>{e.ok&&(await e.json()).versions.forEach((e=>{const t=document.createElement("option");t.value=e;const o=new Date(e[1]);t.textContent=`${e[0].slice(0,6)} - ${o}`,r.appendChild(t)}))})),r.style.marginBottom="15px",r.style.minHeight="25px",i.appendChild(r),super({node:i})}getValue(){return this.inputNode.value}get inputNode(){return this.node.getElementsByTagName("select")[0]}}function d(e,t,o,n){const i=a.ServerConnection.makeSettings();a.ServerConnection.makeRequest(`${i.baseUrl}autoversion/restore?id=${o}&path=${t.path}&version=${n}`,{},i).then((async e=>{if(e.ok){const o=await e.json();o.version.toString()===n&&t.model.fromJSON(o.nb)}}))}function u(e,t,o,n,c){const d=a.ServerConnection.makeSettings();a.ServerConnection.makeRequest(`${d.baseUrl}autoversion/diff?id=${n}&path=${o.path}&version=${c}`,{},d).then((async o=>{if(o.ok){const a=await o.json(),c=new r.NotebookDiffModel(a.base,a.diff),d=new l.NotebookDiffWidget({model:c,rendermime:t,editorFactory:(0,s.createEditorFactory)(),collapseIdentical:!0}),u=d.init();await u;const{shell:v}=e;d.id=n;const p=new i.Panel;p.id=n,p.title.closable=!0,p.title.label=`Diff to ${n}`,p.addClass("nbdime-Widget");const m=new i.Panel;m.addClass("nbdime-root"),m.node.tabIndex=-1,v.add(p),p.addWidget(m),m.addWidget(d),v.activateById(p.id)}}))}t.AutoversionWidget=c},2646:(e,t,o)=>{o.d(t,{A:()=>r});var n=o(1601),a=o.n(n),i=o(6314),s=o.n(i)()(a());s.push([e.id,"",""]);const r=s},8665:(e,t,o)=>{o.r(t),o.d(t,{default:()=>g});var n=o(5072),a=o.n(n),i=o(7825),s=o.n(i),r=o(7659),l=o.n(r),c=o(5056),d=o.n(c),u=o(540),v=o.n(u),p=o(1113),m=o.n(p),b=o(2646),f={};f.styleTagTransform=m(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=s(),f.insertStyleElement=v(),a()(b.A,f);const g=b.A&&b.A.locals?b.A.locals:void 0},1309:e=>{e.exports='<svg data-icon="jupyterlab_autoversion" width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\n\x3c!-- https://github.com/jupyterlab/jupyterlab/blob/master/packages/ui-components/README.md#adding-classes-to-a-one-color-icon --\x3e\n<path\n    class="jp-icon3"\n    fill="#616161"\n    d="M0 436V76c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v151.9L235.5 71.4C256.1 54.3 288 68.6 288 96v131.9L459.5 71.4C480.1 54.3 512 68.6 512 96v320c0 27.4-31.9 41.7-52.5 24.6L288 285.3V416c0 27.4-31.9 41.7-52.5 24.6L64 285.3V436c0 6.6-5.4 12-12 12H12c-6.6 0-12-5.4-12-12z">\n</path>\n</svg>'}}]);