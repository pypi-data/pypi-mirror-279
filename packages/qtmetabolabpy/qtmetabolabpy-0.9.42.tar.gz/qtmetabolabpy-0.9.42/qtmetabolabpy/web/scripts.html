<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>scripts</title>
<meta name="referrer" content="same-origin">
<link rel="canonical" href="https://pypi.org/project/metabolabpytools/scripts.html">
<meta name="robots" content="max-image-preview:large">
<meta name="viewport" content="width=1200">
<style>.anim{visibility:hidden}</style>
<script>!function(){var A=new Image;A.onload=A.onerror=function(){1!=A.height&&document.body.classList.remove("webp")},A.src="data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAD8D+JaQAA3AA/ua1AAA"}();
</script>
<link rel="stylesheet" href="css/site.0d66f9.css" type="text/css">
</head>
<body class="webp" id="b1">
<script>var p=document.createElement("P");p.innerHTML="&nbsp;",p.style.cssText="position:fixed;visible:hidden;font-size:100px;zoom:1",document.body.appendChild(p);var rsz=function(e){return function(){var r=Math.trunc(1e3/parseFloat(window.getComputedStyle(e).getPropertyValue("font-size")))/10,t=document.body;r!=t.style.getPropertyValue("--f")&&t.style.setProperty("--f",r)}}(p);if("ResizeObserver"in window){var ro=new ResizeObserver(rsz);ro.observe(p)}else if("requestAnimationFrame"in window){var raf=function(){rsz(),requestAnimationFrame(raf)};requestAnimationFrame(raf)}else setInterval(rsz,100);</script>

<div data-ffbk class="fbk v1 ps1 s1 c54 z13 fx24" data-fbk="fx24">
<div class="c55 s2">
</div>
<div class="ps2 v2 s3">
<div class="v1 ps3 s224">
<div class="anim fadeIn un114 v1 ps3 s5 c3 z3">
<picture>
<source srcset="images/metabolabpy_dark_transparency-294.webp 1x, images/metabolabpy_dark_transparency-588.webp 2x" type="image/webp">
<source srcset="images/metabolabpy_dark_transparency-294.png 1x, images/metabolabpy_dark_transparency-588.png 2x">
<img src="images/metabolabpy_dark_transparency-588.png" class="i1">
</picture>
</div>
<div class="v1 ps192 s225">
<div class="anim fadeIn un115 v1 ps163 s31 c3 z4">
<p class="p1"><a href="index.html#top" class="f1">MetaboLabPy - Home</a></p>
</div>
<div class="anim fadeIn un116 v1 ps193 s32 c3 z5">
<p class="p1"><a href="index.html#documentation" class="f1">MetaboLabPy - Documentation</a></p>
</div>
<div class="anim fadeIn un117 v1 ps3 s181 c3 z6">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'introduction\']', 2.5, 'easeInOutQuad')" style="cursor:pointer;" href="#introduction" class="f1">Introduction</a></p>
</div>
<div class="anim fadeIn un118 v1 ps227 s32 c3 z161">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'scripts\']', 3.75, 'easeInOutQuad')" style="cursor:pointer;" href="#scripts" class="f1">Scripts</a></p>
</div>
</div>
</div>
<div class="anim fadeIn un119 v1 ps159 s32 c3 z100">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'jupyter\']', 5, 'easeInOutQuad')" style="cursor:pointer;" href="#jupyter" class="f1">Jupyter Notebooks</a></p>
</div>
<div class="v1 ps228 s9">
<div class="v1 ps3 s10">
<div class="anim fadeInLeft un120 v1 ps3 s11 c3 z21">
<p class="p2 f2">MetaboLabPy</p>
</div>
<div class="anim fadeInLeft un121 v1 ps7 s12 c3 z9">
<p class="p2 f3">Scripts &amp; Jupyter Notebooks</p>
</div>
</div>
</div>
</div>
<a name="top" class="v2 ps31 s13"></a>
</div>
<div data-ffbk class="fbk v1 ps63 s226 c56 z7 fx25" data-fbk="fx25">
<div class="c57 s2">
</div>
<div class="ps229 v2 s227">
<div class="v1 ps163 s228">
<div class="v1 ps230 s17 c6 z165"></div>
<div class="anim slideInDown un122 v1 ps231 s18 c3 z11">
<p class="p2 f4">Introduction</p>
</div>
<div class="v1 ps171 s229 c3 z15">
<p class="p3 f5">While most everyday data analysis options can be easily set and executed via the MetaboLabPy GUI, at least partially automated tasks can make data analysis quicker and more reproducible. Reading in a series of 1D-NMR spectra is such an example. While we could click the <span class="f27">Open NMR Spectrum</span> for each spectrum separately, this procedure is not very efficient. Because MetaboLabPy is built as a set of python classes, computational actions can be easily scripted in MetaboLabPy. The <span class="f27">Script</span> tab in the GUI is a good example for this. To facilitate standard actions such as reading in NMR spectra or setting processing parameters, a set of example scripts is included in MetaboLabPy. Each example script is well documented using comments at the end of each code line. In addition we can use non-GUI MetaboLabPy classes and methods via a Jupyter-notebook. There is a series of example Jupyter notebooks distributed with the metabolabpy package.</p>
<p class="p3 f5">In the following we will look at two specific examples, highlighting small differences when using the scripting interface from within the MetaboLabPy GUI and when using Jupyter notebooks.</p>
<p class="p3 f5"><br></p>
</div>
<div class="v1 ps232 s144">
<div class="anim fadeIn un123 v1 ps30 s31 c3 z12">
<p class="p1"><a href="index.html#top" class="f1">MetaboLabPy - Home</a></p>
</div>
<div class="anim fadeIn un124 v1 ps3 s32 c3 z2">
<p class="p1"><a href="index.html#documentation" class="f1">MetaboLabPy - Documentation</a></p>
</div>
<div class="anim fadeIn un125 v1 ps3 s32 c3 z24">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'top\']', 2.5, 'easeInOutQuad')" style="cursor:pointer;" href="#top" class="f1">Scripts &amp; Jupyter Notebooks</a></p>
</div>
<div class="anim fadeIn un126 v1 ps3 s32 c3 z74">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'scripts\']', 2.5, 'easeInOutQuad')" style="cursor:pointer;" href="#scripts" class="f1">Scripts</a></p>
</div>
<div class="anim fadeIn un127 v1 ps3 s32 c3 z83">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'jupyter\']', 5, 'easeInOutQuad')" style="cursor:pointer;" href="#jupyter" class="f1">Jupyter Notebooks</a></p>
</div>
</div>
</div>
<div class="anim fadeIn un128 v1 ps233 s31 c3 z53">
<p class="p1"><a href="index.html#top" class="f1">MetaboLabPy - Home</a></p>
</div>
<div class="v1 ps163 s230">
<div class="v1 ps234 s17 c6 z166"></div>
<div class="v1 ps235 s231">
<div class="anim slideInDown un129 v1 ps3 s232 c3 z28">
<p class="p2 f4">MetaboLabPy Scripts</p>
</div>
<div class="v1 ps213 s233 c3 z16">
<p class="p3 f5">Let&rsquo;s start<span class="f5"> with a script to read in a series of 1D-</span><sup class="f5">1</sup><span class="f5">H NMR data. Please download an example 1D-NMR dataset </span><a href="https://tinyurl.com/nmr1dSeries" class="f6">here</a><span class="f5">. Locate the example scripts pop-up menu located on the lower left corner of the </span><span class="f27">Script</span><span class="f5"> tab. Click on </span><span class="f22">&lsquo;1D Example Script&rsquo;</span><span class="f5">. This will load the text for the 1D example script. Now, change </span><span class="f22">&lsquo;Replace with directory containing Bruker data&rsquo;</span><span class="f5"> with </span><span class="f22">&lsquo;interactive&rsquo;</span><span class="f5"> and replace the square brackets in the line below with the expression </span><span class="f22">np.linspace(1, 4, 4, dtype=int)</span><span class="f5">. This creates a numpy array with the numbers 1, 2, 3 &amp; 4. Alternatively we could have specified each dataset number explicitly and replaced </span><span class="f22">[]</span><span class="f5"> with </span><span class="f22">[1, 2, 3, 4]</span><span class="f5">. After these modifications, we should have a script like this:</span></p>
<p class="p3 f5"><br></p>
</div>
</div>
<div class="v1 ps236 s234">
<div class="anim fadeIn un130 v1 ps193 s32 c3 z154">
<p class="p1"><a href="index.html#documentation" class="f1">MetaboLabPy - Documentation</a></p>
</div>
<div class="anim fadeIn un131 v1 ps193 s32 c3 z65">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'top\']', 5, 'easeInOutQuad')" style="cursor:pointer;" href="#top" class="f1">Scripts &amp; Jupyter Notebooks</a></p>
</div>
<div class="anim fadeIn un132 v1 ps3 s181 c3 z164">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'introduction\']', 2.5, 'easeInOutQuad')" style="cursor:pointer;" href="#introduction" class="f1">Introduction</a></p>
</div>
<div class="anim fadeIn un133 v1 ps237 s32 c3 z62">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'jupyter\']', 2.5, 'easeInOutQuad')" style="cursor:pointer;" href="#jupyter" class="f1">Jupyter Notebooks</a></p>
</div>
</div>
</div>
<div class="v1 ps238 s235 c3 z18">
<p class="p3 f22">msg = self.clear()</p>
<p class="p3 f22">data_path = 'interactive' # select directory containing bruker data, interactive for file dialog</p>
<p class="p3 f22">data_sets = np.linspace(1, 4, 4, dtyp=int)&nbsp;&nbsp;&nbsp;&nbsp;# add comma separated list of experiment numbers&nbsp;</p>
<p class="p3 f22">self.read_spcs([data_path],data_sets)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # reading Bruker spectra</p>
<p class="p3 f22">msg = self.nd.set_zero_fill([131072])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # zero fill to 131072 data points</p>
<p class="p3 f22">msg = self.nd.set_lb([0.3])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # 0.3 Hz line broadening</p>
<p class="p3 f22">msg = self.nd.set_window_type([1])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# exponential window function</p>
<p class="p3 f22">msg = self.nd.ft_all()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Fourier Transform all NMR spectra</p>
<p class="p3 f22">msg = self.nd.auto_ref_all()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# automatically reference to TMSP</p>
<p class="p3 f22">self.nd.e = 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # make first spectrum the current experiment</p>
<p class="p3 f22">self.set_ph_ref_exp(1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# select reference spectrum for manual phase correction</p>
</div>
<div class="v1 ps239 s236 c3 z30">
<p class="p3 f5">After script execution (either clicking <span class="f27">eXecute Script</span> or via the keyboard shortcut Ctrl + x on Windows or <span class="f7">&#x2318;</span><span class="f7"> + </span><span class="f7">x on macOS) the four spectra in that dataset should have been read in, all FIDs will be exponentially line broadened by 0.3 Hz, zero-filled to 131072 data points and auto referenced to TMSP.</span></p>
<p class="p3 f7">The other example scripts show further examples how to use the script interface.</p>
</div>
<a name="scripts" class="v1 ps240 s13"></a>
</div>
<a name="introduction" class="v2 ps241 s13"></a>
<a name="jupyter" class="v2 ps242 s13"></a>
</div>
<div data-ffbk class="fbk v1 ps63 s237 c58 z1 fx26" data-fbk="fx26">
<div class="c59 s2">
</div>
<div class="ps243 v2 s238">
<div class="v1 ps163 s239">
<div class="v1 ps12 s17 c6 z167"></div>
<div class="v1 ps13 s240">
<div class="anim slideInDown un134 v1 ps3 s232 c3 z156">
<p class="p2 f4">Jupyter Notebooks</p>
</div>
<div class="v1 ps244 s241 c3 z36">
<p class="p3 f5">MetaboLabPy ships with a few example Jupyter notebooks (in the metabolabpy/nmr/jupyter subdirectory in the site-packages directory. Please note: In order to be able to run jupyter notebooks, you must have the following to packages installed</p>
<p class="p3 f5"><br></p>
<p class="p3 f5">&nbsp;- jupyter</p>
<p class="p3 f5">&nbsp;- jupyterthemes</p>
<p class="p3 f5"><br></p>
<p class="p3 f5">These packages can be installed with the command <span class="f22">pip install jupyter jupyterthemes</span> in an Anaconda powershelgl prompt or in a macOS Terminal, after the metabolabpy environment has been activated. For convenience, a zip archive with example notebooks can also be downloaded <a href="https://tinyurl.com/jupyterMlPy" class="f6">here</a>.&nbsp;&nbsp;For this tutorial, we are using the file mlpy_2d_spc.ipynb.</p>
<p class="p3 f5">Each jupyter notebook contains several code cells. Each cell can be executed by clicking into the cell and the typing <span class="f7">&#x21e7;</span><span class="f7"> +</span><span class="f7"> Enter.</span></p>
</div>
</div>
<div class="v1 ps245 s242">
<div class="anim fadeIn un135 v1 ps163 s31 c3 z71">
<p class="p1"><a href="index.html#top" class="f1">MetaboLabPy - Home</a></p>
</div>
<div class="anim fadeIn un136 v1 ps193 s32 c3 z56">
<p class="p1"><a href="index.html#documentation" class="f1">MetaboLabPy - Documentation</a></p>
</div>
<div class="anim fadeIn un137 v1 ps193 s32 c3 z66">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'top\']', 5, 'easeInOutQuad')" style="cursor:pointer;" href="#top" class="f1">Scripts &amp; Jupyter Notebooks</a></p>
</div>
<div class="anim fadeIn un138 v1 ps3 s181 c3 z75">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'introduction\']', 5, 'easeInOutQuad')" style="cursor:pointer;" href="#introduction" class="f1">Introduction</a></p>
</div>
<div class="anim fadeIn un139 v1 ps237 s32 c3 z157">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'scripts\']', 2.5, 'easeInOutQuad')" style="cursor:pointer;" href="#scripts" class="f1">Scripts</a></p>
</div>
</div>
</div>
<div class="v1 ps246 s243 c3 z37">
<picture>
<source srcset="images/screenshot-2023-07-25-at-00.03.38-889.webp 1x" type="image/webp">
<source srcset="images/screenshot-2023-07-25-at-00.03.38-889.jpg 1x">
<img src="images/screenshot-2023-07-25-at-00.03.38-889.jpg" loading="lazy" class="i50">
</picture>
</div>
<div class="v1 ps247 s244 c3 z38">
<p class="p3 f5">The first cell in this notebook loads necessary modules from installed packages. The second cell then downloads the sample dataset via an installed web browser.</p>
</div>
<div class="v1 ps248 s245 c3 z40">
<picture>
<source srcset="images/screenshot-2023-07-24-at-22.46.40-889.webp 1x" type="image/webp">
<source srcset="images/screenshot-2023-07-24-at-22.46.40-889.jpg 1x">
<img src="images/screenshot-2023-07-24-at-22.46.40-889.jpg" loading="lazy" class="i51">
</picture>
</div>
<div class="v1 ps177 s246 c3 z159">
<p class="p3 f5">The downloaded dataset is then loaded into a MetaboLabPy nmrDataSet object, phase correction values for zero and first order phase correction are set for both dimensions, the spectrum is phase corrected, referenced and baseline corrected. Then plot parameters are set to ensure that the 2D plot does not render too much noise.</p>
</div>
<div class="v1 ps216 s247 c3 z46">
<picture>
<source srcset="images/screenshot-2023-07-24-at-22.46.53-889.webp 1x" type="image/webp">
<source srcset="images/screenshot-2023-07-24-at-22.46.53-889.jpg 1x">
<img src="images/screenshot-2023-07-24-at-22.46.53-889.jpg" loading="lazy" class="i52">
</picture>
</div>
<div class="v1 ps246 s248 c3 z44">
<p class="p3 f5">At the end, the resulting spectrum is plotted.</p>
</div>
<div class="v1 ps217 s249 c3 z47">
<picture>
<source srcset="images/screenshot-2023-07-24-at-22.47.04-886.webp 1x" type="image/webp">
<source srcset="images/screenshot-2023-07-24-at-22.47.04-886.png 1x">
<img src="images/screenshot-2023-07-24-at-22.47.04-886.png" loading="lazy" class="i53">
</picture>
</div>
<div class="v1 ps249 s248 c3 z158">
<p class="p3 f5">The spectrum is then saved as a MetaboLabPy data file.</p>
</div>
<div class="v1 ps217 s250 c3 z55">
<picture>
<source srcset="images/screenshot-2023-07-25-at-00.12.19-889.webp 1x" type="image/webp">
<source srcset="images/screenshot-2023-07-25-at-00.12.19-889.jpg 1x">
<img src="images/screenshot-2023-07-25-at-00.12.19-889.jpg" loading="lazy" class="i54">
</picture>
</div>
<div class="anim fadeIn un140 v1 ps250 s31 c3 z80">
<p class="p1"><a href="index.html#top" class="f1">MetaboLabPy - Home</a></p>
</div>
<div class="anim fadeIn un141 v1 ps159 s32 c3 z84">
<p class="p1"><a href="index.html#documentation" class="f1">MetaboLabPy - Documentation</a></p>
</div>
<div class="anim fadeIn un142 v1 ps159 s32 c3 z160">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'top\']', 5, 'easeInOutQuad')" style="cursor:pointer;" href="#top" class="f1">Scripts &amp; Jupyter Notebooks</a></p>
</div>
<div class="v1 ps251 s251">
<div class="v1 ps3 s252">
<div class="anim fadeIn un143 v1 ps3 s181 c3 z91">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'introduction\']', 5, 'easeInOutQuad')" style="cursor:pointer;" href="#introduction" class="f1">Introduction</a></p>
</div>
<div class="anim fadeIn un144 v1 ps227 s253 c3 z88">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'scripts\']', 5, 'easeInOutQuad')" style="cursor:pointer;" href="#scripts" class="f1">Scripts</a></p>
</div>
</div>
</div>
<div class="anim fadeIn un145 v1 ps159 s32 c3 z93">
<p class="p1"><a onclick="return window.smoothScroll(event, '[name=\'jupyter\']', 2.5, 'easeInOutQuad')" style="cursor:pointer;" href="#jupyter" class="f1">Jupyter Notebooks</a></p>
</div>
</div>
</div>
<div class="c10">
</div>
<script>dpth="/"</script>
<script type="text/javascript" src="js/fixed.ab122b.js"></script>
<script type="text/javascript" src="js/woolite.ab122b.js"></script>
<script type="text/javascript" src="js/scripts.0d66f9.js"></script>
</body>
</html>