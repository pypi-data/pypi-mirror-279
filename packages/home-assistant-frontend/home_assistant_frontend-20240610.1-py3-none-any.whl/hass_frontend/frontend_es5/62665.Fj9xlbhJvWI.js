"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[62665],{89936:function(t,e,n){var i=n(1781).A,r=n(94881).A;n.a(t,function(){var t=i(r().mark((function t(i,s){var a,c,o,u,l,m,f,d,h,_,v,b,y,p,g,w,k,O;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.r(e),n.d(e,{computeStateDisplay:function(){return k},computeStateDisplayFromEntityAttributes:function(){return O}}),a=n(77052),n.n(a),c=n(53501),n.n(c),o=n(53156),n.n(o),u=n(43859),n.n(u),l=n(34517),n.n(l),m=n(83378),f=n(25786),d=n(31798),h=n(77396),_=n(64854),v=n(60441),b=n(56601),y=n(94646),p=n(47038),!(g=i([h,_,v,b])).then){t.next=30;break}return t.next=26,g;case 26:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=31;break;case 30:t.t0=g;case 31:w=t.t0,h=w[0],_=w[1],v=w[2],b=w[3],k=function(t,e,n,i,r,s,a){var c=null==s?void 0:s[e.entity_id];return O(t,n,i,r,c,e.entity_id,e.attributes,void 0!==a?a:e.state)},O=function(t,e,n,i,r,s,a,c){if(c===m.HV||c===m.Hh)return t("state.default.".concat(c));var o=(0,p.m)(s);if((0,b.ty)(a,"sensor"===o?n:[])){if("duration"===a.device_class&&a.unit_of_measurement&&d.Z[a.unit_of_measurement]&&void 0===(null==r?void 0:r.display_precision))try{return(0,d.a)(c,a.unit_of_measurement)}catch(O){}if("monetary"===a.device_class)try{return(0,b.ZV)(c,e,Object.assign({style:"currency",currency:a.unit_of_measurement,minimumFractionDigits:2},(0,b.ZQ)({state:c,attributes:a},r)))}catch(O){}var u=(0,b.ZV)(c,e,(0,b.ZQ)({state:c,attributes:a},r)),l=a.unit_of_measurement;return l?"".concat(u).concat((0,y.A)(l,e)).concat(l):u}if("datetime"===o){var g=new Date(c);return(0,_.r6)(g,e,i)}if(["date","input_datetime","time"].includes(o))try{var w=c.split(" ");if(2===w.length)return(0,_.r6)(new Date(w.join("T")),Object.assign(Object.assign({},e),{},{time_zone:f.Wj.local}),i);if(1===w.length){if(c.includes("-"))return(0,h.Yq)(new Date("".concat(c,"T00:00")),Object.assign(Object.assign({},e),{},{time_zone:f.Wj.local}),i);if(c.includes(":")){var k=new Date;return(0,v.fU)(new Date("".concat(k.toISOString().split("T")[0],"T").concat(c)),Object.assign(Object.assign({},e),{},{time_zone:f.Wj.local}),i)}}return c}catch(j){return c}if("counter"===o||"number"===o||"input_number"===o)return(0,b.ZV)(c,e,(0,b.ZQ)({state:c,attributes:a},r));if(["button","conversation","event","image","input_button","notify","scene","stt","tag","tts","wake_word"].includes(o)||"sensor"===o&&"timestamp"===a.device_class)try{return(0,_.r6)(new Date(c),e,i)}catch(O){return c}return(null==r?void 0:r.translation_key)&&t("component.".concat(r.platform,".entity.").concat(o,".").concat(r.translation_key,".state.").concat(c))||a.device_class&&t("component.".concat(o,".entity_component.").concat(a.device_class,".state.").concat(c))||t("component.".concat(o,".entity_component._.state.").concat(c))||c},s(),t.next=44;break;case 41:t.prev=41,t.t2=t.catch(0),s(t.t2);case 44:case"end":return t.stop()}}),t,null,[[0,41]])})));return function(e,n){return t.apply(this,arguments)}}())},62665:function(t,e,n){var i=n(1781).A,r=n(94881).A;n.a(t,function(){var t=i(r().mark((function t(i,s){var a,c,o,u,l,m,f,d,h,_,v,b,y,p,g,w,k,O,j,S,H,A,D,T,x,I,Z,z,M,E,W,Q,V,F,q,C,J,U,Y,B,G,K,L,N,P,R,X,$,tt,et,nt,it,rt,st,at;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.d(e,{IQ:function(){return R},Jo:function(){return N},Mm:function(){return st},qc:function(){return at}}),a=n(61780),c=n(66123),o=n(89231),u=n(36683),l=n(77052),n.n(l),m=n(69466),n.n(m),f=n(4187),n.n(f),d=n(53501),n.n(d),h=n(21950),n.n(h),_=n(53156),n.n(_),v=n(36724),n.n(v),b=n(71936),n.n(b),y=n(14460),n.n(y),p=n(62859),n.n(p),g=n(43859),n.n(g),w=n(1158),n.n(w),k=n(68113),n.n(k),O=n(57733),n.n(O),j=n(34517),n.n(j),S=n(56262),n.n(S),H=n(66274),n.n(H),A=n(85038),n.n(A),D=n(85767),n.n(D),T=n(84531),n.n(T),x=n(98168),n.n(x),I=n(22836),n.n(I),Z=n(15445),n.n(Z),z=n(24483),n.n(z),M=n(13478),n.n(M),E=n(46355),n.n(E),W=n(14612),n.n(W),Q=n(53691),n.n(Q),V=n(48455),n.n(V),F=n(34290),n.n(F),q=n(8339),n.n(q),C=n(47038),J=n(89936),U=n(82931),!(Y=i([J])).then){t.next=79;break}return t.next=75,Y;case 75:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=80;break;case 79:t.t0=Y;case 80:J=t.t0[0],B=["climate","humidifier","water_heater"],G=["climate","humidifier","input_datetime","thermostat","water_heater","person","device_tracker"],K=["temperature","current_temperature","target_temp_low","target_temp_high","hvac_action","humidity","mode","action","current_humidity"],L=function(t,e){return!t.states[e]||G.includes((0,C.m)(e))},function(t,e,n,i){var r={type:"history/history_during_period",start_time:e.toISOString(),end_time:n.toISOString(),minimal_response:!0,no_attributes:!i.some((function(e){return L(t,e)}))};return 0!==i.length?t.callWS(Object.assign(Object.assign({},r),{},{entity_ids:i})):t.callWS(r)},N=function(t,e,n,i,r){var s={type:"history/stream",entity_ids:r,start_time:n.toISOString(),end_time:i.toISOString(),minimal_response:!0,no_attributes:!r.some((function(e){return L(t,e)}))},a=new P(t);return t.connection.subscribeMessage((function(t){return e(a.processMessage(t))}),s)},P=function(){return(0,u.A)((function t(e,n){(0,o.A)(this,t),this.hass=void 0,this.hoursToShow=void 0,this.combinedHistory=void 0,this.hass=e,this.hoursToShow=n,this.combinedHistory={}}),[{key:"processMessage",value:function(t){if(!this.combinedHistory||!Object.keys(this.combinedHistory).length)return this.combinedHistory=t.states,this.combinedHistory;if(!Object.keys(t.states).length)return this.combinedHistory;for(var e=this.hoursToShow?((new Date).getTime()-3600*this.hoursToShow*1e3)/1e3:void 0,n={},i=0,r=Object.keys(this.combinedHistory);i<r.length;i++){n[r[i]]=[]}for(var s=0,a=Object.keys(t.states);s<a.length;s++){n[a[s]]=[]}for(var c=0,o=Object.keys(n);c<o.length;c++){var u=o[c];if(u in this.combinedHistory&&u in t.states){var l=this.combinedHistory[u],m=l[l.length-1];n[u]=l.concat(t.states[u]),t.states[u][0].lu<m.lu&&(n[u]=n[u].sort((function(t,e){return t.lu-e.lu})))}else u in this.combinedHistory?n[u]=this.combinedHistory[u]:n[u]=t.states[u];if(e&&u in this.combinedHistory){var f=n[u].filter((function(t){return t.lu<e}));if(!f.length)continue;if(n[u]=n[u].filter((function(t){return t.lu>=e})),n[u].length&&n[u][0].lu===e)continue;var d=f[f.length-1];d.lu=e,n[u].unshift(d)}}return this.combinedHistory=n,this.combinedHistory}}])}(),R=function(t,e,n,i){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6?arguments[6]:void 0,c={type:"history/stream",entity_ids:i,start_time:new Date((new Date).getTime()-3600*n*1e3).toISOString(),minimal_response:r,significant_changes_only:s,no_attributes:null!=a?a:!i.some((function(e){return L(t,e)}))},o=new P(t,n);return t.connection.subscribeMessage((function(t){return e(o.processMessage(t))}),c)},X=function(t,e){return t.state===e.state&&(!t.attributes||!e.attributes||K.every((function(n){return t.attributes[n]===e.attributes[n]})))},$=function(t,e,n,i,r,s,a){var o,u=[],l=s[0],m=(0,c.A)(s);try{for(m.s();!(o=m.n()).done;){var f=o.value;if(!(u.length>0&&f.s===u[u.length-1].state)){var d={};null!=a&&a.attributes.device_class&&(d.device_class=null==a?void 0:a.attributes.device_class),u.push({state_localize:(0,J.computeStateDisplayFromEntityAttributes)(t,e,[],n,i[r],r,Object.assign(Object.assign({},f.a||l.a),d),f.s),state:f.s,last_changed:1e3*(f.lc?f.lc:f.lu)})}}}catch(h){m.e(h)}finally{m.f()}return{name:(0,U._)(r,(null==a?void 0:a.attributes)||l.a),entity_id:r,data:u}},tt=function(t,e,n,i){var r=[];return Object.keys(n).forEach((function(t){var e,s=n[t],a=s[0],o=(0,C.m)(t),u=[],l=(0,c.A)(s);try{for(l.s();!(e=l.n()).done;){var m=e.value,f=void 0;if(B.includes(o)){f={state:m.s,last_changed:1e3*m.lu,attributes:{}};for(var d=0,h=K;d<h.length;d++){var _=h[d];_ in m.a&&(f.attributes[_]=m.a[_])}}else f={state:m.s,last_changed:1e3*(m.lc?m.lc:m.lu),attributes:{}};u.length>1&&X(f,u[u.length-1])&&X(f,u[u.length-2])||u.push(f)}}catch(b){l.e(b)}finally{l.f()}var v=t in i?i[t].attributes:"friendly_name"in a.a?a.a:void 0;r.push({domain:o,name:(0,U._)(t,v||{}),entity_id:t,states:u})})),{unit:t,device_class:e,identifier:Object.keys(n).join(""),data:r}},et=["counter","input_number","number"],nt=function(t){return et.includes(t)},it=function(t){return"unit_of_measurement"in t||"state_class"in t},rt=function(t,e){return null!=t.attributes.device_class&&e.includes(t.attributes.device_class)}," ",st=function(t,e,n,i,r){var s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o={},u=[],l={};return new Set([].concat((0,a.A)(n),(0,a.A)(Object.keys(e)))).forEach((function(n){n in e?l[n]=e[n]:t.states[n]&&(l[n]=[{s:t.states[n].state,a:t.states[n].attributes,lu:new Date(t.states[n].last_updated).getTime()/1e3}])})),l?(Object.keys(l).forEach((function(e){var n,m=l[e];if(0!==m.length){var f,d=(0,C.m)(e),h=e in t.states?t.states[e]:void 0,_=h||nt(d)?void 0:m.find((function(t){return t.a&&it(t.a)}));f=c||nt(d)||null!=h&&it(h.attributes)||null!=h&&"sensor"===d&&rt(h,r)||null!=_?(null==h?void 0:h.attributes.unit_of_measurement)||(null==_?void 0:_.a.unit_of_measurement)||" ":{zone:i("ui.dialogs.more_info_control.zone.graph_unit"),climate:t.config.unit_system.temperature,humidifier:"%",water_heater:t.config.unit_system.temperature}[d];var v={climate:"temperature",humidifier:"humidity",water_heater:"temperature"}[d]||(null===(n=(null==h?void 0:h.attributes)||(null==_?void 0:_.a))||void 0===n?void 0:n.device_class),b=at(f,v,s);if(f)if(b&&b in o&&e in o[b]){var y;(y=o[b][e]).push.apply(y,(0,a.A)(m))}else b&&(b in o||(o[b]={}),o[b][e]=m);else u.push($(i,t.locale,t.config,t.entities,e,m,h))}})),{line:Object.keys(o).map((function(e){var n=e.split("_"),i=n[0],r=n[1]||void 0;return tt(i,r,o[e],t.states)})),timeline:u}):{line:[],timeline:[]}},at=function(t,e,n){return n?"".concat(t,"_").concat(e||""):t},s(),t.next=105;break;case 102:t.prev=102,t.t2=t.catch(0),s(t.t2);case 105:case"end":return t.stop()}}),t,null,[[0,102]])})));return function(e,n){return t.apply(this,arguments)}}())}}]);
//# sourceMappingURL=62665.Fj9xlbhJvWI.js.map